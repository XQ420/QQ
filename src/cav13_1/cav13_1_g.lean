import Mathlib.Data.Real.Basic
import Mathlib.Tactic

theorem cav13_1_g (x₁ x₂ x₃ x₄: ℝ)
                  (h₁ : g₁ = 1 - x₃^2 - x₄^2)
                  (h₂ : g₂ = x₃^2 + x₄ - 1 - x₁)
                  (h₃ : g₃ = x₄ + x₁ * x₄+ 1 - x₂)
                  (h₄ : I = x₁/5 - (3*x₂)/2 + (x₁*x₂)/10 + (9*x₁^2)/10 - (9*x₂^2)/10 - 1/2) :
                  0 ≤ g₁ → 0 = g₂ → 0 = g₃ → 0 ≤ -I := by
  let p₀ : ℝ := x₁/4 - x₂/10 + x₄/5 - (4*x₁*x₄)/25 - (x₂*x₄)/100 - (61*x₃^2)/300 - (9*x₄^2)/100 + 1
  let p₁ : ℝ := (27*x₁)/80 + (3*x₂)/40 - (9*x₄)/100 + (x₁*x₄)/25 - (51*x₂*x₄)/400 - (31*x₃^2)/240 + (29*x₄^2)/400
  let p₂ : ℝ := (43*x₂)/75 - (1327*x₁*x₄)/4500 + (41*x₂*x₄)/1500 - (697*x₃^2)/13500 - (197*x₄^2)/1125
  let p₃ : ℝ := (229*x₄)/250 + (439*x₁*x₄)/1500 - (91*x₂*x₄)/500 + (343*x₃^2)/4500 + (14*x₄^2)/375
  let p₄ : ℝ := (954304007*x₃^2)/1595214000 - (4571*x₂*x₄)/1417968 - (1449163*x₁*x₄)/21269520 + (18686773*x₄^2)/132934500
  let p₅ : ℝ := (44381077779*x₂*x₄)/477152003500 - (28141342701*x₁*x₄)/477152003500 + (94033479178*x₄^2)/119288000875
  let p₆ : ℝ := (26792204160893*x₁*x₄)/37613391671200 + (1822831438769*x₂*x₄)/7522678334240
  let p₇ : ℝ := (831693117366337*x₂*x₄)/1339610208044650
  let p₈ : ℝ := (68*x₃)/75 - (27*x₁*x₃)/100 - (19*x₂*x₃)/100 + (7*x₃*x₄)/25
  let p₉ : ℝ := (2063*x₃*x₄)/1700 - (29*x₂*x₃)/1360 - (453*x₁*x₃)/6800
  let q₀ : ℝ := (152247*x₁*x₃)/1650400 + (1253989*x₂*x₃)/1650400
  let q₁ : ℝ := (101507563*x₁*x₃)/250797800

  let q₂ : ℝ := (3*x₁)/10 - x₂/20 + 4/5
  let q₃ : ℝ := (31*x₁)/80 + (27*x₂)/160 - x₄/10
  let q₄ : ℝ := (897*x₂)/1240 + (29*x₄)/310
  let q₅ : ℝ := (7733*x₄)/8970
  let q₆ : ℝ := x₃

  let δ₀ : ℝ := p₀^2 + 80/27*p₁^2 + 75/43*p₂^2 + 250/229*p₃^2 + 1595214000/954304007*p₄^2 + 119288000875/94033479178*p₅^2
                + 37613391671200/26792204160893*p₆^2 + 1339610208044650/831693117366337*p₇^2 + 75/68*p₈^2
                + 1700/2063*p₉^2 + 1650400/1253989*q₀^2 + 250797800/101507563*q₁^2
  let δ₁ : ℝ := 5/4*q₂^2 + 80/31*q₃^2 + 1240/897*q₄^2 + 8970/7733*q₅^2 + q₆^2
  let δ₂ : ℝ := (9*x₁)/5 - x₂/10 - x₄/2 + (3*x₁*x₄)/5 + (x₂*x₄)/5 + (3*x₃^2)/10 + (3*x₄^2)/10 + 1/10
  let δ₃ : ℝ := (3*x₁)/5 + x₂/2 + x₄/5 - (x₁*x₄)/2 - x₃^2/2 - (3*x₄^2)/10 - 6/5
  have I₁ : -I = δ₀ + δ₁*g₁ + δ₂*g₂ + δ₃*g₃ := by
    simp [h₁,h₂,h₃,h₄]
    linear_combination
  intro g1 g2 g3
  rw [I₁]
  have h1 : 0 ≤ δ₀ := by
    have : 0 ≤ (x₁/4 - x₂/10 + x₄/5 - (4*x₁*x₄)/25 - (x₂*x₄)/100 - (61*x₃^2)/300 - (9*x₄^2)/100 + 1)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((27*x₁)/80 + (3*x₂)/40 - (9*x₄)/100 + (x₁*x₄)/25 - (51*x₂*x₄)/400 - (31*x₃^2)/240 + (29*x₄^2)/400)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((43*x₂)/75 - (1327*x₁*x₄)/4500 + (41*x₂*x₄)/1500 - (697*x₃^2)/13500 - (197*x₄^2)/1125)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((229*x₄)/250 + (439*x₁*x₄)/1500 - (91*x₂*x₄)/500 + (343*x₃^2)/4500 + (14*x₄^2)/375)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((954304007*x₃^2)/1595214000 - (4571*x₂*x₄)/1417968 - (1449163*x₁*x₄)/21269520 + (18686773*x₄^2)/132934500)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((44381077779*x₂*x₄)/477152003500 - (28141342701*x₁*x₄)/477152003500 + (94033479178*x₄^2)/119288000875)^2 := by apply pow_two_nonneg
    have : 0 ≤ (26792204160893 * x₁ * x₄ / 37613391671200 + 1822831438769 * x₂ * x₄ / 7522678334240)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((831693117366337 * x₂ * x₄) ^ 2 / 1339610208044650 ^ 2) := by
      rw [←div_pow]
      have : 0 ≤ ((831693117366337*x₂*x₄)/1339610208044650)^2 := by apply pow_two_nonneg
      linarith
    have : 0 ≤ ((68*x₃)/75 - (27*x₁*x₃)/100 - (19*x₂*x₃)/100 + (7*x₃*x₄)/25)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((2063*x₃*x₄)/1700 - (29*x₂*x₃)/1360 - (453*x₁*x₃)/6800)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((152247*x₁*x₃)/1650400 + (1253989*x₂*x₃)/1650400)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((101507563 * x₁ * x₃) ^ 2 / 250797800 ^ 2) := by
      rw [←div_pow]
      have : 0 ≤ ((101507563*x₁*x₃)/250797800) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have h2 : 0 ≤ δ₁*g₁ := by
    have : 0 ≤ δ₁ := by
      have : 0 ≤ ((3*x₁)/10 - x₂/20 + 4/5)^2 := by apply pow_two_nonneg
      have : 0 ≤ ((31*x₁)/80 + (27*x₂)/160 - x₄/10)^2 := by apply pow_two_nonneg
      have : 0 ≤ ((897*x₂)/1240 + (29*x₄)/310)^2 := by apply pow_two_nonneg
      have : 0 ≤ ((7733 * x₄) ^ 2 / 8970 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ ((7733*x₄)/8970)^2 := by apply pow_two_nonneg
        linarith
      have : 0 ≤  x₃^2 := by apply pow_two_nonneg
      simp
      linarith
    exact Right.mul_nonneg this g1
  have h3 : 0 ≤ δ₂*g₂ := by rw [←g2]; linarith
  have h4 : 0 ≤ δ₃*g₃ := by rw [←g3]; linarith
  linarith
