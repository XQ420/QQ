import Mathlib.Data.Real.Basic
import Mathlib.Tactic

theorem ist22_1_f_1 (x₁ x₂ : ℝ)
                    (h₁ : f₁ = (x₁-1.2)*(5-x₁))
                    (h₂ : f₂ = (x₂-2.2)*(5-x₂))
                    (h₃ : I = (213*x₁)/25 - (303*x₂)/20 - (4071*x₁^2*x₂^2)/100 - (53*x₁*x₂)/20 - (1749*x₁*x₂^2)/100
                          + (1231*x₁^2*x₂)/50 + (2981*x₁*x₂^3)/100 + (1029*x₁^3*x₂)/50 - (383*x₁^2)/100
                          - (327*x₁^3)/25 + (1741*x₂^2)/50 - (91*x₁^4)/100 - (2181*x₂^3)/100 - (101*x₂^4)/100 - 193/50) :
                    0 ≤ f₁ → 0 ≤ f₂ → 0 < I := by
  let p₀ : ℝ := (107223*x₁*x₂)/2000 - (304531*x₂)/1000 - (55543*x₁)/1000 - (2176*x₁^2)/125 + (31051*x₂^2)/750 + 4165799/10000
  let p₁ : ℝ := (68909183272*x₂)/1562174625 - (435508557923*x₁)/8331598000 - (47473994291*x₁*x₂)/8331598000
                + (4081328467*x₁^2)/245047000 - (104797208207*x₂^2)/12497397000
  let p₂ : ℝ := (519234758904335*x₁)/17640750917632 - (31363433970394077*x₁*x₂)/2205093864704000
                + (129665644190093*x₁^2)/1102546932352000 + (1864443166071551*x₂^2)/3307640797056000
  let p₃ : ℝ := (326435984557091411*x₁^2)/821573985608125000 - (1214187607882478429*x₁*x₂)/1643147971216250000
                + (1036993470744463453*x₂^2)/3697082935236562500
  let p₄ : ℝ := (34452459594643866069707*x₁*x₂)/78645584821260108275520 - (37989231943084801604379*x₁^2)/65537987351050090229600
  let p₅ : ℝ := (14528848857832271322653*x₁^2)/615222492761497608387625

  let p₆ : ℝ := (1801*x₁)/100 - (1511*x₂)/40 + 4833/100
  let p₇ : ℝ := (802219*x₂)/386640 - (1105927*x₁)/483300
  let p₈ : ℝ := (18035893*x₁)/401109500

  let p₉ : ℝ := 593/50 - (251*x₂)/100 - (41*x₁)/25
  let q₀ : ℝ := (153677*x₂)/23720 - (1168457*x₁)/118600
  let q₁ : ℝ := (276848057*x₁)/153677000

  let σ₀ : ℝ := 10000/4165799*p₀^2 + 1562174625/68909183272*p₁^2 + 17640750917632/519234758904335*p₂^2
                + 3697082935236562500/1036993470744463453*p₃^2 + 78645584821260108275520/34452459594643866069707*p₄^2
                + 615222492761497608387625/14528848857832271322653*p₅^2
  let σ₁ : ℝ := 100/4833*p₆^2 + 386640/802219*p₇^2 + 401109500/18035893*p₈^2
  let σ₂ : ℝ := 50/593*p₉^2 + 23720/153677*q₀^2 + 153677000/276848057*q₁^2
  let ε : ℝ := 1/10000

  have I₁ : I = σ₀ + σ₁*f₁ + σ₂*f₂ + ε := by
    simp [h₁,h₂,h₃]
    linear_combination
  intro f1 f2
  have h1 : 0 ≤ σ₀ := by
    have : 0 ≤ ((107223*x₁*x₂)/2000 - (304531*x₂)/1000 - (55543*x₁)/1000 - (2176*x₁^2)/125 + (31051*x₂^2)/750 + 4165799/10000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((68909183272*x₂)/1562174625 - (435508557923*x₁)/8331598000 - (47473994291*x₁*x₂)/8331598000
                + (4081328467*x₁^2)/245047000 - (104797208207*x₂^2)/12497397000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((519234758904335*x₁)/17640750917632 - (31363433970394077*x₁*x₂)/2205093864704000
                + (129665644190093*x₁^2)/1102546932352000 + (1864443166071551*x₂^2)/3307640797056000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((326435984557091411*x₁^2)/821573985608125000 - (1214187607882478429*x₁*x₂)/1643147971216250000
                + (1036993470744463453*x₂^2)/3697082935236562500)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((34452459594643866069707*x₁*x₂)/78645584821260108275520 - (37989231943084801604379*x₁^2)/65537987351050090229600)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((14528848857832271322653 * x₁ ^ 2) ^ 2 / 615222492761497608387625 ^ 2) := by
      rw [←div_pow]
      have : 0 ≤ ((14528848857832271322653*x₁^2)/615222492761497608387625) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have h2 : 0 ≤ σ₁*f₁ := by
    have : 0 ≤ σ₁ := by
      have : 0 ≤ ((1801*x₁)/100 - (1511*x₂)/40 + 4833/100) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((802219*x₂)/386640 - (1105927*x₁)/483300) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((18035893 * x₁) ^ 2 / 401109500 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ ((18035893*x₁)/401109500) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this f1
  have h3 : 0 ≤ σ₂*f₂ := by
    have : 0 ≤ σ₂ := by
      have : 0 ≤ (593/50 - (251*x₂)/100 - (41*x₁)/25) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((153677*x₂)/23720 - (1168457*x₁)/118600) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((276848057 * x₁) ^ 2 / 153677000 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ ((276848057*x₁)/153677000) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this f2
  have h4 : 0 < ε := by norm_num
  linarith
