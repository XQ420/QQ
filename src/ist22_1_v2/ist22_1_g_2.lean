import Mathlib.Data.Real.Basic
import Mathlib.Tactic

theorem ist22_1_g_2 (x₁ x₂ : ℝ)
                    (h₁ : g₃ = (2-x₁)*(x₁-1))
                    (h₂ : g₄ = (2-x₂)*x₂)
                    (h₃ : I = (213*x₁)/25 - (303*x₂)/20 - (4071*x₁^2*x₂^2)/100 - (53*x₁*x₂)/20 - (1749*x₁*x₂^2)/100
                          + (1231*x₁^2*x₂)/50 + (2981*x₁*x₂^3)/100 + (1029*x₁^3*x₂)/50 - (383*x₁^2)/100
                          - (327*x₁^3)/25 + (1741*x₂^2)/50 - (91*x₁^4)/100 - (2181*x₂^3)/100 - (101*x₂^4)/100 - 193/50) :
                    0 ≤ g₃ → 0 ≤ g₄ → 0 ≤ -I := by
  let p₀ : ℝ := (431*x₁*x₂)/100 - (569*x₂)/200 - (2307*x₁)/200 + (403*x₁^2)/300 - (147*x₂^2)/100 + 307/25
  let p₁ : ℝ := (3335679*x₂)/491200 - (3213627*x₁)/491200 + (1406927*x₁*x₂)/245600 - (630907*x₁^2)/736800 - (1149547*x₂^2)/245600
  let p₂ : ℝ := (517599653*x₁)/111189300 + (1721186369*x₁*x₂)/444757200 - (4900929541*x₁^2)/1334271600 - (269091799*x₂^2)/111189300
  let p₃ : ℝ := (25403329879043*x₁^2)/5590076252400 - (18687233620903*x₁*x₂)/1863358750800 + (567136455287*x₂^2)/116459921925
  let p₄ : ℝ := (3570576067045421*x₁*x₂)/10889019941510400 - (133713964176355*x₁^2)/435560797660416
  let p₅ : ℝ := (28063561672405213*x₁^2)/3213518460340878900

  let p₆ : ℝ := 421/100 - (309*x₂)/200 - (12*x₁)/25
  let p₇ : ℝ := (333939*x₂)/168400 - (30061*x₁)/10525
  let p₈ : ℝ := (43604521*x₁)/16696950

  let p₉ : ℝ := (2*x₁)/25 - (269*x₂)/40 + 733/100
  let q₀ : ℝ := (689039*x₂)/293200 - (1119*x₁)/733
  let q₁ : ℝ := (3958183*x₁)/68903900

  let δ₀ : ℝ := 25/307*p₀^2 + 491200/3335679*p₁^2 + 111189300/517599653*p₂^2 + 116459921925/567136455287*p₃^2
                + 10889019941510400/3570576067045421*p₄^2 + 3213518460340878900/28063561672405213*p₅^2
  let δ₁ : ℝ := 100/421*p₆^2 + 168400/333939*p₇^2 + 16696950/43604521*p₈^2
  let δ₂ : ℝ := 100/733*p₉^2 + 293200/689039*q₀^2 + 68903900/3958183*q₁^2

  have I₁ : -I = δ₀ + δ₁*g₃ + δ₂*g₄ := by
    simp [h₁, h₂, h₃]
    linear_combination
  intro g3 g4
  rw [I₁]
  have h1 : 0 ≤ δ₀ := by
    have : 0 ≤ ((431*x₁*x₂)/100 - (569*x₂)/200 - (2307*x₁)/200 + (403*x₁^2)/300 - (147*x₂^2)/100 + 307/25)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((3335679*x₂)/491200 - (3213627*x₁)/491200 + (1406927*x₁*x₂)/245600 - (630907*x₁^2)/736800 - (1149547*x₂^2)/245600)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((517599653*x₁)/111189300 + (1721186369*x₁*x₂)/444757200 - (4900929541*x₁^2)/1334271600 - (269091799*x₂^2)/111189300)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((25403329879043*x₁^2)/5590076252400 - (18687233620903*x₁*x₂)/1863358750800 + (567136455287*x₂^2)/116459921925)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((3570576067045421*x₁*x₂)/10889019941510400 - (133713964176355*x₁^2)/435560797660416)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((28063561672405213*x₁^2)^2/3213518460340878900^2) := by
      rw [←div_pow]
      have : 0 ≤ ((28063561672405213*x₁^2)/3213518460340878900) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have h2 : 0 ≤ δ₁*g₃ := by
    have : 0 ≤ δ₁ := by
      have : 0 ≤ (421/100 - (309*x₂)/200 - (12*x₁)/25) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((333939*x₂)/168400 - (30061*x₁)/10525) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((43604521*x₁)^2/16696950^2) := by
        rw [←div_pow]
        have : 0 ≤ ((43604521*x₁)/16696950) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this g3
  have h3 : 0 ≤ δ₂*g₄ := by
    have : 0 ≤ δ₂ := by
      have : 0 ≤ ((2*x₁)/25 - (269*x₂)/40 + 733/100) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((689039*x₂)/293200 - (1119*x₁)/733) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((3958183*x₁)^2/68903900^2) := by
        rw [←div_pow]
        have : 0 ≤ ((3958183*x₁)/68903900) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this g4
  linarith
