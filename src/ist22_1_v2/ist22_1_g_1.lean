import Mathlib.Data.Real.Basic
import Mathlib.Tactic

set_option maxHeartbeats 500000

theorem ist22_1_g_1 (x₁ x₂ : ℝ)
                    (h₁ : g₁ = (1-x₁)*(x₁+1))
                    (h₂ : g₂ = (3-x₂)*x₂)
                    (h₃ : I = (213*x₁)/25 - (303*x₂)/20 - (4071*x₁^2*x₂^2)/100 - (53*x₁*x₂)/20 - (1749*x₁*x₂^2)/100
                          + (1231*x₁^2*x₂)/50 + (2981*x₁*x₂^3)/100 + (1029*x₁^3*x₂)/50 - (383*x₁^2)/100
                          - (327*x₁^3)/25 + (1741*x₂^2)/50 - (91*x₁^4)/100 - (2181*x₂^3)/100 - (101*x₂^4)/100 - 193/50) :
                    0 ≤ g₁ → 0 ≤ g₂ → 0 ≤ -I := by
  let p₀ : ℝ := (49*x₂)/50 - (92*x₁)/25 + (1927*x₁*x₂)/400 + (19*x₁*x₂^2)/600
                + (61*x₁^2*x₂)/100 - (329*x₁^2)/100 + (487*x₁^3)/400 - (217*x₂^2)/50 + (337*x₂^3)/400 + 29/10
  let p₁ : ℝ := (31013*x₂)/14500 - (37057*x₁)/58000 + (28481*x₁*x₂)/174000 - (27031*x₁*x₂^2)/87000 + (13541*x₁^2*x₂)/14500
                - (3691*x₁^2)/3625 - (19679*x₁^3)/174000 - (80091*x₂^2)/58000 + (14807*x₂^3)/58000
  let p₂ : ℝ := (212344751*x₁)/49620800 - (395655823*x₁*x₂)/148862400 + (17824349*x₁*x₂^2)/14886240 - (28605139*x₁^2*x₂)/37215600
                + (10152951*x₁^2)/12405200 - (313923887*x₁^3)/148862400 - (74154617*x₂^2)/148862400 + (549451*x₂^3)/9924160
  let p₃ : ℝ := (71707743589*x₁^2)/84937900400 - (455854793977*x₁*x₂^2)/764441103600 - (65099600681*x₁^2*x₂)/382220551800
                - (3420166785721*x₁*x₂)/764441103600 + (176364796199*x₁^3)/152888220720 + (177992915347*x₂^2)/47777568975 - (154897909429*x₂^3)/254813701200
  let p₄ : ℝ := (517528698749791*x₁*x₂)/120616375576320 - (469181614119011*x₁*x₂^2)/603081877881600 - (88124331565201*x₁^2*x₂)/100513646313600
                - (228399117583151*x₁^2)/201027292627200 - (825179977860353*x₁^3)/603081877881600 - (23572230701089*x₂^3)/201027292627200
  let p₅ : ℝ := (261001686646066148159*x₁^2)/140767806059943152000 - (124575907098951025661*x₁^2*x₂)/70383903029971576000 - (1754278712153829021*x₁*x₂^2)/8280459179996656000
                + (58276632662672426003*x₁^3)/105575854544957364000 + (10387948892571054511*x₂^3)/52787927272478682000
  let p₆ : ℝ := (2464314234754622425391*x₁^2*x₂)/15660101198763968889540 - (105499588607270401697593*x₁*x₂^2)/156601011987639688895400
                + (130912759724326466661943*x₁^3)/939606071925838133372400 + (21683361473868187079401*x₂^3)/93960607192583813337240
  let p₇ : ℝ := (72616074819219837439453711*x₁*x₂^2)/195150253264813683714609000 - (948668871471388762161047*x₁^2*x₂)/1084168073693409353970050
                + (2024862616553689653808447*x₁^3)/43366722947736374158802000
  let p₈ : ℝ := (8156247082903743532110157403*x₁^2*x₂)/21784822445765951231836113300
                - (1908416900169708333453630531*x₁^3)/3630803740960991871972685550
  let p₉ : ℝ := (207452471330200599965501710647*x₁^3)/652499766632299482568812592240

  let q₀ : ℝ := x₂/10 - (29*x₁)/50 - (3*x₁*x₂)/100 - x₁^2/20 - (29*x₂^2)/50 + 24/25
  let q₁ : ℝ := (547*x₂)/480 - (67*x₁)/480 - (443*x₁*x₂)/1600 - (1127*x₁^2)/4800 - (1439*x₂^2)/2400
  let q₂ : ℝ := (26837*x₁)/13675 - (10069*x₁*x₂)/109400 - (8396*x₁^2)/13675 - (29749*x₂^2)/54700
  let q₃ : ℝ := (46342109*x₂^2)/53674000 - (10570797*x₁^2)/26837000 - (72922251*x₁*x₂)/107348000
  let q₄ : ℝ := (1337442197*x₁*x₂)/926842180 - (3022927463*x₁^2)/4634210900
  let q₅ : ℝ := (7870507019091*x₁^2)/2674884394000

  let q₆ : ℝ := (9*x₁*x₂)/25 - (809*x₂)/200 - (23*x₁)/50 - (173*x₁^2)/150 + (49*x₂^2)/60 + 433/100
  let q₇ : ℝ := (487337*x₂)/519600 - (13411*x₁)/43300 - (26187*x₁*x₂)/173200 - (5437*x₁^2)/32475 - (21569*x₂^2)/64950
  let q₈ : ℝ := (80083067*x₁)/73100550 - (18559839*x₁*x₂)/24366850 - (26156257*x₁^2)/73100550 + (12818339*x₂^2)/116960880
  let q₉ : ℝ := (20385418153*x₁^2)/288299041200 - (4069717847*x₁*x₂)/6406645360 + (801298962581*x₂^2)/2306392329600
  let t₀ : ℝ := (29684117491711*x₁*x₂)/73966058084400 - (30239264400*x₁^2)/61638381737
  let t₁ : ℝ := (15740806059408913*x₁^2)/57884029108836450

  let δ₀ : ℝ := 10/29*p₀^2 + 14500/31013*p₁^2 + 49620800/212344751*p₂^2
                + 47777568975/177992915347*p₃^2 + 120616375576320/517528698749791*p₄^2
                + 140767806059943152000/261001686646066148159*p₅^2 + 93960607192583813337240/21683361473868187079401*p₆^2
                + 195150253264813683714609000/72616074819219837439453711*p₇^2 + 21784822445765951231836113300/8156247082903743532110157403*p₈^2
                + 652499766632299482568812592240/207452471330200599965501710647*p₉^2
  let δ₁ : ℝ := 25/24*q₀^2 + 480/547*q₁^2 + 13675/26837*q₂^2 + 53674000/46342109*q₃^2 + 926842180/1337442197*q₄^2 + 2674884394000/7870507019091*q₅^2
  let δ₂ : ℝ := 100/433*q₆^2 + 519600/487337*q₇^2 + 73100550/80083067*q₈^2 + 2306392329600/801298962581*q₉^2
                + 73966058084400/29684117491711*t₀^2 + 57884029108836450/15740806059408913*t₁^2
  have I₁ : -I = δ₀ + δ₁*g₁ + δ₂*g₂ := by
    simp [h₁, h₂, h₃]
    linear_combination
  intro g1 g2
  rw [I₁]
  have h1 : 0 ≤ δ₀ := by
    have : 0 ≤ ((49*x₂)/50 - (92*x₁)/25 + (1927*x₁*x₂)/400 + (19*x₁*x₂^2)/600
                + (61*x₁^2*x₂)/100 - (329*x₁^2)/100 + (487*x₁^3)/400 - (217*x₂^2)/50 + (337*x₂^3)/400 + 29/10)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((31013*x₂)/14500 - (37057*x₁)/58000 + (28481*x₁*x₂)/174000 - (27031*x₁*x₂^2)/87000 + (13541*x₁^2*x₂)/14500
                - (3691*x₁^2)/3625 - (19679*x₁^3)/174000 - (80091*x₂^2)/58000 + (14807*x₂^3)/58000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((212344751*x₁)/49620800 - (395655823*x₁*x₂)/148862400 + (17824349*x₁*x₂^2)/14886240 - (28605139*x₁^2*x₂)/37215600
                + (10152951*x₁^2)/12405200 - (313923887*x₁^3)/148862400 - (74154617*x₂^2)/148862400 + (549451*x₂^3)/9924160)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((71707743589*x₁^2)/84937900400 - (455854793977*x₁*x₂^2)/764441103600 - (65099600681*x₁^2*x₂)/382220551800
                - (3420166785721*x₁*x₂)/764441103600 + (176364796199*x₁^3)/152888220720 + (177992915347*x₂^2)/47777568975 - (154897909429*x₂^3)/254813701200)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((517528698749791*x₁*x₂)/120616375576320 - (469181614119011*x₁*x₂^2)/603081877881600 - (88124331565201*x₁^2*x₂)/100513646313600
                - (228399117583151*x₁^2)/201027292627200 - (825179977860353*x₁^3)/603081877881600 - (23572230701089*x₂^3)/201027292627200)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((261001686646066148159*x₁^2)/140767806059943152000 - (124575907098951025661*x₁^2*x₂)/70383903029971576000 - (1754278712153829021*x₁*x₂^2)/8280459179996656000
                + (58276632662672426003*x₁^3)/105575854544957364000 + (10387948892571054511*x₂^3)/52787927272478682000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((2464314234754622425391*x₁^2*x₂)/15660101198763968889540 - (105499588607270401697593*x₁*x₂^2)/156601011987639688895400
                + (130912759724326466661943*x₁^3)/939606071925838133372400 + (21683361473868187079401*x₂^3)/93960607192583813337240)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((72616074819219837439453711*x₁*x₂^2)/195150253264813683714609000 - (948668871471388762161047*x₁^2*x₂)/1084168073693409353970050
                + (2024862616553689653808447*x₁^3)/43366722947736374158802000)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((8156247082903743532110157403*x₁^2*x₂)/21784822445765951231836113300
                - (1908416900169708333453630531*x₁^3)/3630803740960991871972685550)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((207452471330200599965501710647 * x₁ ^ 3) ^ 2 / 652499766632299482568812592240 ^ 2) := by
      rw [←div_pow]
      have : 0 ≤ ((207452471330200599965501710647*x₁^3)/652499766632299482568812592240) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have h2 : 0 ≤ δ₁*g₁ := by
    have : 0 ≤ δ₁ := by
      have : 0 ≤ (x₂/10 - (29*x₁)/50 - (3*x₁*x₂)/100 - x₁^2/20 - (29*x₂^2)/50 + 24/25) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((547*x₂)/480 - (67*x₁)/480 - (443*x₁*x₂)/1600 - (1127*x₁^2)/4800 - (1439*x₂^2)/2400) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((26837*x₁)/13675 - (10069*x₁*x₂)/109400 - (8396*x₁^2)/13675 - (29749*x₂^2)/54700) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((46342109*x₂^2)/53674000 - (10570797*x₁^2)/26837000 - (72922251*x₁*x₂)/107348000) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((1337442197*x₁*x₂)/926842180 - (3022927463*x₁^2)/4634210900) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((7870507019091 * x₁ ^ 2) ^ 2 / 2674884394000 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤ ((7870507019091*x₁^2)/2674884394000) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this g1
  have h3 : 0 ≤ δ₂*g₂ := by
    have : 0 ≤ δ₂ := by
      have : 0 ≤ ((9*x₁*x₂)/25 - (809*x₂)/200 - (23*x₁)/50 - (173*x₁^2)/150 + (49*x₂^2)/60 + 433/100) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((487337*x₂)/519600 - (13411*x₁)/43300 - (26187*x₁*x₂)/173200 - (5437*x₁^2)/32475 - (21569*x₂^2)/64950) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((80083067*x₁)/73100550 - (18559839*x₁*x₂)/24366850 - (26156257*x₁^2)/73100550 + (12818339*x₂^2)/116960880) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((20385418153*x₁^2)/288299041200 - (4069717847*x₁*x₂)/6406645360 + (801298962581*x₂^2)/2306392329600) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((29684117491711*x₁*x₂)/73966058084400 - (30239264400*x₁^2)/61638381737) ^ 2 := by apply pow_two_nonneg
      have : 0 ≤ ((15740806059408913*x₁^2)^2/57884029108836450^2) := by
        rw [←div_pow]
        have : 0 ≤ ((15740806059408913*x₁^2)/57884029108836450) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg this g2
  linarith
