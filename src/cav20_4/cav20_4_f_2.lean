import Mathlib.Tactic


theorem cav20_4_2 (x₁ x₂ x₅ x₆: ℝ)
             (h₁ : f₃ = 16-16*(x₁+x₂)^2-(x₁-x₂-4)^2-x₅^2)
             (h₂ : f₄ = x₁-x₂-x₆^2-(1-x₆)^2)
             (h₃ : I = (3*x₁)/100 + (2*x₂)/25 - (103*x₁*x₂)/50 - (3*x₁^2)/100 - x₂^2/50 + 91/100):
              0 ≤ f₃ ∧ 0 ≤ f₄
                →  I > 0 := by
  let p₀: ℝ :=(67*x₂)/200 - (7*x₁)/25 - (21*x₆)/200 + (7*x₁*x₂)/100 - (3*x₁*x₆)/400 + (3*x₂*x₆)/400 + (13*x₁^2)/100 + (19*x₂^2)/150 - x₅^2/20 - (13*x₆^2)/300 + 10099/10000
  let p₁: ℝ :=(901203*x₁)/1009900 - (51933*x₂)/201980 + (94479*x₆)/4039600 - (921401*x₁*x₂)/4039600 - (119489*x₁*x₆)/4039600 - (185581*x₂*x₆)/3029700 - (116727*x₁^2)/403960 - (429929*x₂^2)/2423760 - (288277*x₅^2)/4039600 - (98171*x₆^2)/605940
  let p₂: ℝ :=(18056899*x₂)/22530075 - (656733*x₆)/60080200 + (9526277*x₁*x₂)/60080200 - (25005941*x₁*x₆)/360481200 - (17172263*x₂*x₆)/360481200 + (2069627*x₁^2)/24032080 + (16717213*x₂^2)/72096240 + (364416*x₅^2)/7510025 + (9705317*x₆^2)/90120300
  let p₃: ℝ :=(2692981201*x₆)/6190936800 - (114466339*x₁*x₂)/773867100 - (23426713*x₁*x₆)/330183296 + (2024076737*x₂*x₆)/24763747200 - (455949581*x₁^2)/8254582400 - (1399619593*x₂^2)/24763747200 - (8391913*x₅^2)/825458240 - (921151561*x₆^2)/6190936800
  let p₄: ℝ :=(3587573133481*x₁*x₂)/8617539843200 - (3280466068153*x₁*x₆)/34470159372800 - (4426200336227*x₂*x₆)/103410478118400 + (13216929937759*x₁^2)/34470159372800 + (1522363715301*x₂^2)/34470159372800 - (54749430807*x₅^2)/17235079686400 + (1447332379511*x₆^2)/25852619529600
  let p₅: ℝ :=(61257086783793289*x₁*x₂)/166533317215763400 + (9054960607573891*x₁*x₆)/166533317215763400 + (106457696809769*x₂*x₆)/1051789371889032 + (4737940298135462*x₂^2)/12489998791182255 - (968445314789573*x₅^2)/333066634431526800 + (2312767394712473*x₆^2)/49959995164729020
  let p₆: ℝ :=(829082944733208263*x₁*x₂)/75807044770167392000 - (232486517118456323*x₁*x₆)/75807044770167392000 + (145027584226620697*x₂*x₆)/45484226862100435200 + (1302903424073264149*x₅^2)/151614089540334784000 - (32451296525895363*x₆^2)/7580704477016739200
  let p₇: ℝ :=(245439545575586417*x₁*x₂)/12608742813612233700 - (13644496569689039363*x₁*x₆)/390871027221979244700 + (45785863509302877257*x₂*x₆)/1172613081665937734100 + (49075239684389253004*x₆^2)/293153270416484433525
  let p₈: ℝ :=(2962462253232861226681*x₁*x₂)/58890287621267103604800 + (267425838397375390089*x₁*x₆)/19630095873755701201600 - (690838936165184409067*x₂*x₆)/58890287621267103604800
  let p₉: ℝ :=(1746345935450305032766517*x₁*x₆)/3554954703879433472017200 + (1438190068565150198903371*x₂*x₆)/3554954703879433472017200
  let p₁₀: ℝ :=(250794304719837822611698067*x₂*x₆)/1571711341905274529489865300
  let p₁₁: ℝ :=(21*x₅)/100 - (23*x₁*x₅)/400 + (x₂*x₅)/16 - (19*x₅*x₆)/400
  let p₁₂: ℝ :=(559*x₂*x₅)/33600 - (521*x₁*x₅)/33600 + (2999*x₅*x₆)/33600
  let p₁₃: ℝ :=(350887*x₁*x₅)/1199600 + (184917*x₂*x₅)/599800
  let p₁₄: ℝ :=(5036269*x₁*x₅)/147933600
  let p₀': ℝ := x₂/100 - x₁/100 - x₆/200 + 3/50
  let p₁': ℝ := (17*x₁)/600 + x₂/150 - (7*x₆)/1200
  let p₂': ℝ := (91*x₂)/3400 + (49*x₆)/6800
  let p₃': ℝ := (379*x₆)/10400
  let p₄': ℝ := x₅/50
  let p0: ℝ :=x₂/200 - x₁/200 - x₆/200 + 1/10
  let p1: ℝ :=(279*x₁)/4000 + (81*x₂)/4000 - (41*x₆)/4000
  let p2: ℝ :=(99*x₂)/1550 + (41*x₆)/3100
  let p3: ℝ :=(2683*x₆)/19800
  let p4: ℝ :=x₅/20
  let ε: ℝ :=  1/10000
  let σ₀₂: ℝ :=10000/10099*(p₀^2) +1009900/901203*(p₁^2) +22530075/18056899*(p₂^2) +6190936800/2692981201*(p₃^2) +
      34470159372800/13216929937759*(p₄^2) +12489998791182255/4737940298135462*(p₅^2) +151614089540334784000/1302903424073264149*(p₆^2) +
      293153270416484433525/49075239684389253004*(p₇^2) +58890287621267103604800/2962462253232861226681*(p₈^2) +3554954703879433472017200/1746345935450305032766517*(p₉^2) +
      1571711341905274529489865300/250794304719837822611698067*(p₁₀^2) +100/21*(p₁₁^2) +33600/2999*(p₁₂^2) +599800/184917*(p₁₃^2) +147933600/5036269*(p₁₄^2)
  let σ₂₁: ℝ := 50/3*(p₀'^2) + 600/17*(p₁'^2) + 3400/91*(p₂'^2) + 10400/379*(p₃'^2) + 50*(p₄'^2)
  let σ₂₂: ℝ :=10*(p0^2) +4000/279*(p1^2) + 1550/99*(p2^2) +19800/2683*(p3^2) +20*(p4^2)
  have h1 :10000/10099*(p₀^2) + 1009900/901203*(p₁^2) + 22530075/18056899*(p₂^2) + 6190936800/2692981201*(p₃^2) +
      34470159372800/13216929937759*(p₄^2) + 12489998791182255/4737940298135462*(p₅^2) + 151614089540334784000/1302903424073264149*(p₆^2) +
      293153270416484433525/49075239684389253004*(p₇^2) + 58890287621267103604800/2962462253232861226681*(p₈^2) + 3554954703879433472017200/1746345935450305032766517*(p₉^2) +
      1571711341905274529489865300/250794304719837822611698067*(p₁₀^2) + 100/21*(p₁₁^2) +
      33600/2999*(p₁₂^2) + 599800/184917*(p₁₃^2) + 147933600/5036269*(p₁₄^2)= σ₀₂ := by exact rfl
  have h2 : 50/3*(p₀'^2) + 600/17*(p₁'^2) + 3400/91*(p₂'^2) + 10400/379*(p₃'^2) + 50*(p₄'^2) = σ₂₁ := by exact rfl
  have h3 : 10*(p0^2) +4000/279*(p1^2) + 1550/99*(p2^2) +19800/2683*(p3^2) +20*(p4^2) = σ₂₂ := by exact rfl
  have D₁: I = σ₀₂ + σ₂₁*f₃ + σ₂₂*f₄ + ε := by
    rw [h₁,h₂,h₃]
    linear_combination
  have l₀: σ₀₂ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
          exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁
    have : p₂ ^ 2 ≥ 0 := by
          exact sq_nonneg p₂
    have : p₃ ^ 2 ≥ 0 := by
          exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
          exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
          exact sq_nonneg p₅
    have : p₆ ^ 2 ≥ 0 := by
          exact sq_nonneg p₆
    have : p₇ ^ 2 ≥ 0 := by
          exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
          exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
          exact sq_nonneg p₉
    have : p₁₀ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₀
    have : p₁₁ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₁
    have : p₁₂ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₂
    have : p₁₃ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₃
    have : p₁₄ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₄
    linarith
  have l₁: σ₂₁ ≥ 0 := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    have : p₄' ^ 2 ≥ 0 := by
      exact sq_nonneg p₄'
    linarith
  have l₂: σ₂₂ ≥ 0 := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    have : p4 ^ 2 ≥ 0 := by
        exact sq_nonneg p4
    linarith
  rw [D₁]
  intro f
  have h5 : ε >  0 := by norm_num
  have s₁ : 0 ≤ σ₂₁*f₃ := by
    exact Right.mul_nonneg l₁ f.left
  have s₂ : 0 ≤ σ₂₂*f₄  := by
    exact Right.mul_nonneg l₂ f.right
  linarith
