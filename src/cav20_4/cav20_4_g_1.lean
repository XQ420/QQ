import Mathlib.Tactic

theorem cav20_4_3 (x₁ x₂ x₃ x₄ x₅ x₆: ℝ)
            (h₁ : g₁=16-(x₁+x₂-4)^2-16*(x₁-x₂)^2-x₃^2)
            (h₂ : g₂=x₁+x₂-x₄^2-(2-x₄)^2)
            (h₃ : I = (3*x₁)/100 + (2*x₂)/25 - (103*x₁*x₂)/50 - (3*x₁^2)/100 - x₂^2/50 + 91/100)
              :
              0 ≤ g₁ ∧ 0 ≤ g₂
              → I ≤ 0 := by

  let p₀: ℝ := (6*x₁^2)/25 - (9*x₂)/20 - (19*x₄)/50 - (27*x₁*x₂)/100 - (13*x₁*x₄)/400 - (29*x₂*x₄)/400 - (93*x₁)/200 + (37*x₂^2)/150 + (2*x₃^2)/75 + (29*x₄^2)/300 + 77/100
  let p₁: ℝ := (5231*x₁)/6160 + (1821*x₂)/15400 - (8377*x₄)/30800 + (4141*x₁*x₂)/30800 - (11681*x₁*x₄)/61600 + (42113*x₂*x₄)/184800 - (181*x₁^2)/770 - (3343*x₂^2)/30800 - (967*x₃^2)/30800 - (4593*x₄^2)/30800
  let p₂: ℝ := (3637693*x₂)/3923250 - (2162553*x₄)/10462000 + (2887369*x₁*x₂)/10462000 + (586679*x₁*x₄)/1961625 - (2684573*x₂*x₄)/10462000 - (66751*x₁^2)/418480 - (1625431*x₂^2)/5231000 - (157159*x₃^2)/5231000 - (1833377*x₄^2)/10462000
  let p₃: ℝ := (4511500073*x₄)/6984370560 + (17565952243*x₁*x₂)/34921852800 - (225825441*x₁*x₄)/2910154400 - (1484060147*x₂*x₄)/34921852800 - (2472527463*x₁^2)/11640617600 - (750132809*x₂^2)/3492185280 - (62740177*x₃^2)/17460926400 - (14985768587*x₄^2)/34921852800
  let p₄: ℝ := (8124002614321*x₂*x₄)/54138000876000 - (4898182293233*x₁*x₄)/18046000292000 - (1965866681967*x₁*x₂)/4511500073000 + (3995753105997*x₁^2)/9023000146000 + (8679055252*x₂^2)/338362505475 + (89712638711*x₃^2)/27069000438000 + (4136977571*x₄^2)/563937509125
  let p₅: ℝ := (381326317286537*x₁*x₄)/1917961490878560 - (121893544854209*x₁*x₂)/319660248479760 - (8960663964069227*x₂*x₄)/28769422363178400 + (5898574613736833*x₂^2)/14384711181589200 + (38205898890587*x₃^2)/14384711181589200 + (1392806341783*x₄^2)/958980745439280
  let p₆: ℝ := (48700234562330149*x₃^2)/7078289536484199600 - (2280287961364923*x₁*x₄)/674122812998495200 - (59746339853255899*x₂*x₄)/14156579072968399200 - (774545638630383*x₁*x₂)/94377193819789328 - (49482448170640993*x₄^2)/7078289536484199600
  let p₇: ℝ := (1123128502140846319*x₄^2)/4383021110609713410 - (32684190433873159*x₁*x₄)/389601876498641192 - (14600789051539212373*x₂*x₄)/175320844424388536400 - (46567174112241781*x₁*x₂)/2922014073739808940
  let p₈: ℝ := (2817318504519419851*x₁*x₂)/44925140085633852760 - (6494360780780429843*x₁*x₄)/224625700428169263800 - (85517048472942750161*x₂*x₄)/2695508405138031165600
  let p₉: ℝ := (17936601296391151416101*x₁*x₄)/67615644108466076424000 - (3642539174878903642831*x₂*x₄)/16903911027116519106000
  let p₁₀: ℝ := (35889193032650226099310081*x₂*x₄)/430478431113387633986424000
  let p₁₁: ℝ := (43*x₃)/150 - (3*x₁*x₃)/80 - (x₂*x₃)/25 - (4*x₃*x₄)/25
  let p₁₂: ℝ := (39*x₃*x₄)/430 - (513*x₂*x₃)/17200 - (489*x₁*x₃)/17200
  let p₁₃: ℝ := (88157*x₂*x₃)/624000 - (27993*x₁*x₃)/208000
  let p₁₄: ℝ := (2478973*x₁*x₃)/169261440
  let p₀': ℝ :=3/50 - (3*x₂)/200 - x₄/50 - x₁/100
  let p₁': ℝ :=(23*x₁)/600 - x₂/80 - (11*x₄)/600
  let p₂': ℝ :=(37*x₂)/1150 - (239*x₄)/9200
  let p₃': ℝ :=(2793*x₄)/118400
  let p₄': ℝ :=x₃/100
  let p0: ℝ :=x₂/100 + (23*x₄)/200 + 21/50
  let p1: ℝ :=x₁/10 - x₂/20 - (3*x₄)/100
  let p2: ℝ :=(89*x₂)/1050 - (359*x₄)/8400
  let p3: ℝ :=(353099*x₄)/1424000
  let p4: ℝ :=(7*x₃)/100
  let δ₀₁: ℝ :=100/77*(p₀^2) + 6160/5231*(p₁^2) + 3923250/3637693*(p₂^2) + 6984370560/4511500073*(p₃^2) +9023000146000/3995753105997*(p₄^2) + 14384711181589200/5898574613736833*(p₅^2) +
    7078289536484199600/48700234562330149*(p₆^2) + 4383021110609713410/1123128502140846319*(p₇^2) +
    44925140085633852760/2817318504519419851*(p₈^2) +67615644108466076424000/17936601296391151416101*(p₉^2) +
    430478431113387633986424000/35889193032650226099310081*(p₁₀^2) + 150/43*(p₁₁^2) + 430/39*(p₁₂^2) + 624000/88157*(p₁₃^2) +169261440/2478973*(p₁₄^2)
  let δ₁₁: ℝ :=50/3*(p₀'^2) + 600/23*(p₁'^2) + 1150/37*(p₂'^2) + 118400/2793*(p₃'^2) + 100*(p₄'^2)
  let δ₁₂: ℝ :=50/21*(p0^2) + 10*(p1^2) + 1050/89*(p2^2) + 1424000/353099*(p3^2) + 100/7*(p4^2)
  have h1 :100/77*(p₀^2) + 6160/5231*(p₁^2) + 3923250/3637693*(p₂^2) + 6984370560/4511500073*(p₃^2) +9023000146000/3995753105997*(p₄^2) + 14384711181589200/5898574613736833*(p₅^2) +
    7078289536484199600/48700234562330149*(p₆^2) + 4383021110609713410/1123128502140846319*(p₇^2) +44925140085633852760/2817318504519419851*(p₈^2) +67615644108466076424000/17936601296391151416101*(p₉^2) +
    430478431113387633986424000/35889193032650226099310081*(p₁₀^2) + 150/43*(p₁₁^2) + 430/39*(p₁₂^2) + 624000/88157*(p₁₃^2) +169261440/2478973*(p₁₄^2)= δ₀₁ := by exact rfl
  have h2 :50/3*(p₀'^2) + 600/23*(p₁'^2) + 1150/37*(p₂'^2) + 118400/2793*(p₃'^2) + 100*(p₄'^2)= δ₁₁ := by  exact rfl
  have h3 :50/21*(p0^2) + 10*(p1^2) + 1050/89*(p2^2) + 1424000/353099*(p3^2) + 100/7*(p4^2)= δ₁₂ := by  exact rfl
  have D₁: I = -δ₀₁ - δ₁₁*g₁- δ₁₂*g₂ := by
    simp [h₁,h₂,h₃]
    linear_combination
  have l₀ : δ₀₁ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁
    have : p₂ ^ 2  ≥ 0 := by
      exact sq_nonneg p₂
    have : p₃ ^ 2  ≥ 0 := by
      exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
      exact sq_nonneg p₅
    have : p₆ ^ 2 ≥ 0 := by
      exact sq_nonneg p₆
    have : p₇ ^ 2 ≥ 0 := by
      exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
      exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
      exact sq_nonneg p₉
    have : p₁₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₀
    have : p₁₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₁
    have : p₁₂ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₂
    have : p₁₃ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₃
    have : p₁₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₄
    linarith
  have l₁: 0 ≤ δ₁₁ := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    have : p₄' ^ 2 ≥ 0 := by
      exact sq_nonneg p₄'
    linarith
  have l₂: 0 ≤ δ₁₂ := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    have : p4 ^ 2 ≥ 0 := by
        exact sq_nonneg p4
    linarith
  rw [D₁]
  intro g
  have s₁ : 0 ≤ δ₁₁*g₁ := by
    exact Right.mul_nonneg l₁ g.left
  have s₂ : 0 ≤ δ₁₂*g₂  := by
    exact Right.mul_nonneg l₂ g.right
  linarith
