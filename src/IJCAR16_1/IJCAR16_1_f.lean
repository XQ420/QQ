import Mathlib.Tactic




theorem IJACAR16_1_f (x₁ x₂ x₃: ℝ)
             (h₁ : f₁=-3 *x₁^2 - x₂^2 + 1)
             (h₂ : f₂ = x₂ - x₃^2)
             (h₃: I = (21*x₂)/10 - (29*x₁)/10 - (5*x₁*x₂)/2 - (7*x₁^2)/10 - (6*x₂^2)/5 + 29/10)
             (h₄: γ₁ = (25*x₁)/36 + (5*x₂)/24 + (5*x₁*x₂)/18 + (125*x₁^2)/72 + (73*x₂^2)/72 + (17*x₃^2)/12 + 25/18):
              0 ≤ f₁ ∧  0 ≤ f₂
                → 0 < (γ₁ + 1) * I := by

  let p₀: ℝ := (16391*x₂)/13920 - (2099*x₁)/720 - (150343307863066271*x₁*x₂)/130604389193744384 - (934932166890149477*x₁^2)/77822201560962170880 - (30641028484045472551*x₂^2)/35263185082310983680 + (9277901961287642417*x₃^2)/47017580109747978240 + 19733/4500
  let p₁: ℝ := (3692910556622532263802697*x₁)/767832751701233258987520 - (5701120645325971645919*x₂)/7731649235880473788416 + (161878560148812505256305*x₁*x₂)/989651102192700644917248 - (244548768480368453740493*x₁^2)/175504628960281887768576 - (5341463974151803263742511*x₂^2)/11133574899667882255319040 - (279876229368302894921699*x₃^2)/530170233317518202634240
  let p₂: ℝ := (4589091805947004918627140170812438158672780611*x₂)/1888244932533706248699604014993192588851281920 - (22919898808916119599504265386008260913484702667*x₁*x₂)/20141279280359533319462442826594054281080340480 - (1034148539526090130141176862763102345369059277*x₁^2)/4444971979113828042915849451386274048238419968 + (2512628738207243492813492160698760365632315213*x₂^2)/10070639640179766659731221413297027140540170240 - (3584199358375377011274815021549301009807527507*x₃^2)/13427519520239688879641628551062702854053560320
  let p₃: ℝ := (157762468700398178802194186535730195027574048380351290595791158411696042544934027813*x₁^2)/30880993349940331963771372877063769056423215726635228574108525801434541257104818176 - (54386022272474070615528462687612740535529813072118680228767286527992200627780141*x₁*x₂)/70671465210564206672140925933936971483291765788543373472944069463510234884472832 + (34472880185846925736937529368123796562644852163677440188667026570730773689018909187*x₂^2)/69964750558458564605419516674597601768458848130657939738214628768875132535628103680 + (43037329043870705359552712890990756934753498090967309545836984084259158026678060619*x₃^2)/93286334077944752807226022232796802357945130840877252984286171691833510047504138240
  let p₄: ℝ := (3922531323787514987505114064860049672095626601604015811942322712337710822053068461550466705577048916921189*x₂^2)/2151106758025448021854870426774261703877691201092815127644644149955444928447404350979291069530436848844800 - (26786572621444716847200264989928952749565022330908726631338805926357209901050350750122968968461329947663*x₁*x₂)/28681423440339306958064939023656822718369216014570868368595255332739265712632058013057214260405824651264 - (1471664937448390668436401368100948720178954930826168171827769021916902320284444300144649933806722969931*x₃^2)/9192763923185675307072095840915648307169620517490662938652325427160021061741044234954235339873661747200
  let p₅: ℝ := (8966823278017099622736040282262851025738717223946225610977753949042571297211421133035885944606391406013903857938547846391693637*x₃^2)/3565606661150721911702778276930642287787032381357288167804471938817133901387893697686027465532007312094882967819176217893928960 - (7696374247257378276279939902060490906098511489385000957362755921224200725962971841420667653277761398952017784393870138833056747*x₁*x₂)/9508284429735258431207408738481712767432086350286101780811925170179023737034383193829406574752019498919687914184469914383810560
  let p₆: ℝ := (657324980841837012277657227032287458360801140579252292657601246417961174233742797013714289557403782163458075317303316798637071826826517756226179795*x₁*x₂)/112426221814432519700722056692923556611279740935307732315029066614171270638917320958990141189148035261694745372018995784010924590968777544059322368
  let p₇: ℝ := (92573255411509809871*x₃)/23508790054873989120 - (457385904175668291*x₁*x₃)/326510972984360960 - (2162684016049209191*x₂*x₃)/5224175567749775360
  let p₈: ℝ := (859101789851099107696297678829720678959*x₂*x₃)/263792148626110486478962002379942133760 - (39548251868960504974569842505266718409*x₁*x₃)/32974018578263810809870250297492766720
  let p₉: ℝ := (93674492221346889655984403693317822527575716411524910126387*x₁*x₃)/18513406645594632256174602701125054934963905106515580682240

  let p₀': ℝ := (11*x₁)/24 + (7*x₂)/16 + 61/24
  let p₁': ℝ := (3173*x₁)/1464 + (647*x₂)/1464
  let p₂': ℝ := (321657*x₂)/101536
  let p₃': ℝ := (13*x₃)/6

  let p0: ℝ := 208/87 - (61*x₂)/87 - x₁/174
  let p1: ℝ := (42709*x₁)/24128 - (893*x₂)/36192
  let p2: ℝ := (26404496*x₂)/11147049
  let p3: ℝ := (8*x₃)/3

  let ε: ℝ := 1/1000
  let δ₀: ℝ := 4500/19733*(p₀^2) +
            767832751701233258987520/3692910556622532263802697*(p₁^2) +
            1888244932533706248699604014993192588851281920/4589091805947004918627140170812438158672780611*(p₂^2) +
            30880993349940331963771372877063769056423215726635228574108525801434541257104818176/157762468700398178802194186535730195027574048380351290595791158411696042544934027813*(p₃^2) +
            2151106758025448021854870426774261703877691201092815127644644149955444928447404350979291069530436848844800/3922531323787514987505114064860049672095626601604015811942322712337710822053068461550466705577048916921189*(p₄^2) +
            3565606661150721911702778276930642287787032381357288167804471938817133901387893697686027465532007312094882967819176217893928960/8966823278017099622736040282262851025738717223946225610977753949042571297211421133035885944606391406013903857938547846391693637*(p₅^2) +
            112426221814432519700722056692923556611279740935307732315029066614171270638917320958990141189148035261694745372018995784010924590968777544059322368/657324980841837012277657227032287458360801140579252292657601246417961174233742797013714289557403782163458075317303316798637071826826517756226179795*(p₆^2) +
            23508790054873989120/92573255411509809871*(p₇^2) +
            263792148626110486478962002379942133760/859101789851099107696297678829720678959*(p₈^2) +
            18513406645594632256174602701125054934963905106515580682240/93674492221346889655984403693317822527575716411524910126387*(p₉^2)
  let δ₁: ℝ := 24/61*(p₀'^2) + 1464/3173*(p₁'^2) + 101536/321657*(p₂'^2) + 6/13*(p₃'^2)
  let δ₂: ℝ := 87/208*(p0^2) + 24128/42709*(p1^2) + 11147049/26404496*(p2^2) +3/8*(p3^2)
  have D₁: (γ₁ + 1) * I = δ₀ + δ₁*f₁ + δ₂*f₂ + ε := by
    simp [h₁, h₂, h₃,h₄]
    linear_combination
  intro f
  have l₀: 0 ≤ δ₀ := by
    have : 0 ≤ ((16391*x₂)/13920 - (2099*x₁)/720 - (150343307863066271*x₁*x₂)/130604389193744384 - (934932166890149477*x₁^2)/77822201560962170880 -
     (30641028484045472551*x₂^2)/35263185082310983680 + (9277901961287642417*x₃^2)/47017580109747978240 + 19733/4500)^2:= by exact sq_nonneg p₀
    have : 0 ≤ ((3692910556622532263802697*x₁)/767832751701233258987520 - (5701120645325971645919*x₂)/7731649235880473788416 +
     (161878560148812505256305*x₁*x₂)/989651102192700644917248 - (244548768480368453740493*x₁^2)/175504628960281887768576 - (5341463974151803263742511*x₂^2)/11133574899667882255319040
      - (279876229368302894921699*x₃^2)/530170233317518202634240) ^ 2 := by exact sq_nonneg p₁
    have : 0 ≤ ((4589091805947004918627140170812438158672780611*x₂)/1888244932533706248699604014993192588851281920 -
     (22919898808916119599504265386008260913484702667*x₁*x₂)/20141279280359533319462442826594054281080340480 -
      (1034148539526090130141176862763102345369059277*x₁^2)/4444971979113828042915849451386274048238419968 +
       (2512628738207243492813492160698760365632315213*x₂^2)/10070639640179766659731221413297027140540170240 -
        (3584199358375377011274815021549301009807527507*x₃^2)/13427519520239688879641628551062702854053560320)^ 2 := by exact sq_nonneg p₂
    have : 0 ≤ ((157762468700398178802194186535730195027574048380351290595791158411696042544934027813*x₁^2)/30880993349940331963771372877063769056423215726635228574108525801434541257104818176
     - (54386022272474070615528462687612740535529813072118680228767286527992200627780141*x₁*x₂)/70671465210564206672140925933936971483291765788543373472944069463510234884472832
      + (34472880185846925736937529368123796562644852163677440188667026570730773689018909187*x₂^2)/69964750558458564605419516674597601768458848130657939738214628768875132535628103680
       + (43037329043870705359552712890990756934753498090967309545836984084259158026678060619*x₃^2)/93286334077944752807226022232796802357945130840877252984286171691833510047504138240) ^ 2 := by exact sq_nonneg p₃
    have : 0 ≤ ((3922531323787514987505114064860049672095626601604015811942322712337710822053068461550466705577048916921189*x₂^2)/2151106758025448021854870426774261703877691201092815127644644149955444928447404350979291069530436848844800
     - (26786572621444716847200264989928952749565022330908726631338805926357209901050350750122968968461329947663*x₁*x₂)/28681423440339306958064939023656822718369216014570868368595255332739265712632058013057214260405824651264
      - (1471664937448390668436401368100948720178954930826168171827769021916902320284444300144649933806722969931*x₃^2)/9192763923185675307072095840915648307169620517490662938652325427160021061741044234954235339873661747200) ^ 2 := by exact sq_nonneg p₄
    have : 0 ≤ ((8966823278017099622736040282262851025738717223946225610977753949042571297211421133035885944606391406013903857938547846391693637*x₃^2)/3565606661150721911702778276930642287787032381357288167804471938817133901387893697686027465532007312094882967819176217893928960
     - (7696374247257378276279939902060490906098511489385000957362755921224200725962971841420667653277761398952017784393870138833056747*x₁*x₂)/9508284429735258431207408738481712767432086350286101780811925170179023737034383193829406574752019498919687914184469914383810560) ^ 2 := by exact sq_nonneg p₅
    have : 0 ≤ (657324980841837012277657227032287458360801140579252292657601246417961174233742797013714289557403782163458075317303316798637071826826517756226179795*x₁*x₂)^2/112426221814432519700722056692923556611279740935307732315029066614171270638917320958990141189148035261694745372018995784010924590968777544059322368^2 := by
      rw [←div_pow]
      have : 0 ≤((657324980841837012277657227032287458360801140579252292657601246417961174233742797013714289557403782163458075317303316798637071826826517756226179795*x₁*x₂)/112426221814432519700722056692923556611279740935307732315029066614171270638917320958990141189148035261694745372018995784010924590968777544059322368) ^ 2 := by apply pow_two_nonneg
      linarith
    have : 0 ≤ ((92573255411509809871*x₃)/23508790054873989120 - (457385904175668291*x₁*x₃)/326510972984360960 - (2162684016049209191*x₂*x₃)/5224175567749775360) ^ 2:= by exact sq_nonneg p₇
    have : 0 ≤ ((859101789851099107696297678829720678959*x₂*x₃)/263792148626110486478962002379942133760 - (39548251868960504974569842505266718409*x₁*x₃)/32974018578263810809870250297492766720)^ 2:= by exact sq_nonneg p₈
    have : 0 ≤ (93674492221346889655984403693317822527575716411524910126387*x₁*x₃)^2/18513406645594632256174602701125054934963905106515580682240^2 := by
      rw [←div_pow]
      have : 0 ≤((93674492221346889655984403693317822527575716411524910126387*x₁*x₃)/18513406645594632256174602701125054934963905106515580682240) ^ 2 := by apply pow_two_nonneg
      linarith
    simp
    linarith
  have s₁ : 0 ≤ δ₁*f₁ := by
    have l₁: 0 ≤ δ₁ := by
      have : 0 ≤ ((11*x₁)/24 + (7*x₂)/16 + 61/24) ^ 2 := by exact sq_nonneg p₀'
      have : 0 ≤ ((3173*x₁)/1464 + (647*x₂)/1464) ^ 2 := by exact sq_nonneg p₁'
      have : 0 ≤ ((321657*x₂)^ 2/101536^ 2) := by
        rw [←div_pow]
        have : 0 ≤((321657*x₂)/101536) ^ 2 := by apply pow_two_nonneg
        exact sq_nonneg p₂'
      have : 0 ≤ ((13*x₃) ^ 2/6 ^ 2) := by
        rw [←div_pow]
        have : 0 ≤((13*x₃) /6) ^ 2 := by apply pow_two_nonneg
        linarith
      simp
      linarith
    exact Right.mul_nonneg l₁ f.left
  have s₂ : 0 ≤ δ₂*f₂  := by
    have l₂: 0 ≤ δ₂ := by
      have : 0 ≤ (208/87 - (61*x₂)/87 - x₁/174) ^ 2 := by exact sq_nonneg p0
      have : 0 ≤ ((42709*x₁)/24128 - (893*x₂)/36192) ^ 2 := by exact sq_nonneg p1
      have : 0 ≤ ((26404496*x₂)^ 2 /11147049^ 2)  := by
       rw [←div_pow]
       have : 0 ≤ ((26404496*x₂) /11147049) ^ 2 := by apply pow_two_nonneg
       exact sq_nonneg p2
      have :  0 ≤ ((8*x₃)^ 2/3 ^ 2):= by
       rw [←div_pow]
       have : 0 ≤ ((8*x₃)/3 ) ^ 2 := by apply pow_two_nonneg
       linarith
      simp
      linarith
    exact Right.mul_nonneg l₂ f.right
  rw [D₁]
  have h1 : ε >  0 := by norm_num
  linarith
