import Mathlib.Tactic


theorem IJACAR16_1_g (x₁ x₂ x₃: ℝ)
            (h₁ : g₁=-x₁^2 + 4*x₁ + x₂ - 4)
            (h₂ : g₂ = -x₃^2 - x₁- x₂ + 3)
            (h₃ : I = (21*x₂)/10 - (29*x₁)/10 - (5*x₁*x₂)/2 - (7*x₁^2)/10 - (6*x₂^2)/5 + 29/10)
            (h₄ : γ₂ = (9*x₁)/26 + x₂/13 - (11*x₁*x₂)/26 + (21*x₁^2)/13 + (33*x₂^2)/26 + (16*x₃^2)/13 + 37/26)
              :
              0 ≤ g₁ ∧ 0 ≤ g₂
              → (γ₂ + 1) * I ≤ 0 := by
  let p₀: ℝ := 20347/4940 - (5119*x₂)/9880 - (186795895861880086941*x₁*x₂)/177982257273682001920 - (6915261268699158809*x₁^2)/11123891079605125120 - (5377573565036336819*x₂^2)/22247782159210250240 - (2055412143171943019*x₃^2)/5134103575202365440 - (5133*x₁)/4940
  let p₁: ℝ := (94947649985174390338663*x₁)/22633781179672548081664 - (1043962647333088760401*x₂)/55713922903809349124096 - (665066924074234854900073*x₁*x₂)/724280997749521538613248 - (71248108088202699285825*x₁^2)/45267562359345096163328 - (2913840292502817525901*x₂^2)/13928480725952337281024 - (14619064882856946399461*x₃^2)/17410600907440421601280
  let p₂: ℝ := (3035387511075596017978045764505982903416065737*x₂)/540767906150170158611719058258937491719454720 - (1538367546852829433170217707688776488242510603*x₁*x₂)/540767906150170158611719058258937491719454720 - (2424496975357762309072656492422565828372559*x₁^2)/6759598826877126982646488228236718646493184 - (284623448292816939944424948046145943904301819*x₂^2)/135191976537542539652929764564734372929863680 - (12486145522545072336791255189450847838681337*x₃^2)/20278796480631380947939464684710155939479552
  let p₃: ℝ := (61189676077769344494993168833732394858100705340993479129484897770451080223728611*x₁*x₂)/64027571717661770192180233687530786916719885898982413599294117521483982627143680 + (225205140540649012527639071898705809943286623822454203245384956530475527420133797*x₁^2)/76032741414723352103214027503942809463604864505041616149161764556762229369733120 - (2658315512190589720193100865284947829212390706650731036173110833671693613763737*x₂^2)/24010339394123163822067587632824045093769957212118405099735294070556493485178880 - (12872501674154348182357039491207146309261023031271713135450161317392617789721919*x₃^2)/152065482829446704206428055007885618927209729010083232298323529113524458739466240
  let p₄: ℝ := (818646542448848242154864033313847154358805408743975824981699763958084758441506329069900103432107073*x₁*x₂)/4219212554006474231613710503426563785386085981920430657351322988300677848190896870099989418653777920 + (31775472113681667262342526975457701185571636717324566926967321513363892073427273283119097407383827653*x₂^2)/45092834170944193350371531005371400456313793931774602650442264437463494502540210299193636911862251520 - (46378661643104455497261928534669243919589538311450041891631364280630110149688259552530183354279447*x₃^2)/385408839067899088464713940216849576549690546425423954277284311431311918825130002557210571896258560
  let p₅: ℝ := (52762754918630813482299806445272923658536401770443073969646829703995248534424497788690376162987111676244893308895860091*x₁*x₂)/16966410758189995616700799728409721629303446320645701138732688013487800479192129521151198232059962893648721688715885281280 + (2047387167406990856798976232446496495686202722162191555120167667564934922683955470879733711191751337585566234572002677303*x₃^2)/1325500840483593407554749978782009502289331743800445401463491251053734412436885118839937361879684601066306381930928537600
  let p₆: ℝ := (12774059214065658090915140639966325033301097042730934044821287658666127185366892864706554204862982613948932990634861168043255995172576801608737*x₁*x₂)/5381886861315929929147702423119713521436714503083845585293727755295089108026673235140993982199077146806906448443647584849515618149682999459840
  let p₇: ℝ := (9189113952926808683*x₃)/2567051787601182720 - (3590747131054856609*x₁*x₃)/1711367858400788480 - (7013940665610420363*x₂*x₃)/5561945539802562560
  let p₈: ℝ := (2577979050391290598482504475072967441*x₁*x₃)/25554675682609379183055487103129354240 + (4491504608408216105952756006100429555439*x₂*x₃)/1993264703243531576278327994044089630720
  let p₉: ℝ := (594555383985694120793939288823813191906706790305448304076993*x₁*x₃)/199852032189909863185822224447299328409352284781870286110720

  let p₀': ℝ := (7*x₁)/13 + (10*x₂)/13 + 47/13
  let p₁': ℝ := (1502*x₁)/611 - (211*x₂)/611
  let p₂': ℝ := (57439*x₂)/19526
  let p₃': ℝ := (35*x₃)/13

  let p0: ℝ := 21/19 - (2*x₂)/19 - (3*x₁)/19
  let p1: ℝ := (172*x₁)/133 - (23*x₂)/133
  let p2: ℝ := (15155*x₂)/9804
  let p3: ℝ := (35*x₃)/19

  let σ₀: ℝ := 4940/20347*(p₀^2) +
              22633781179672548081664/94947649985174390338663*(p₁^2) +
              540767906150170158611719058258937491719454720/3035387511075596017978045764505982903416065737*(p₂^2) +
              76032741414723352103214027503942809463604864505041616149161764556762229369733120/225205140540649012527639071898705809943286623822454203245384956530475527420133797*(p₃^2) +
              45092834170944193350371531005371400456313793931774602650442264437463494502540210299193636911862251520/31775472113681667262342526975457701185571636717324566926967321513363892073427273283119097407383827653*(p₄^2) +
              1325500840483593407554749978782009502289331743800445401463491251053734412436885118839937361879684601066306381930928537600/2047387167406990856798976232446496495686202722162191555120167667564934922683955470879733711191751337585566234572002677303*(p₅^2) +
              5381886861315929929147702423119713521436714503083845585293727755295089108026673235140993982199077146806906448443647584849515618149682999459840/12774059214065658090915140639966325033301097042730934044821287658666127185366892864706554204862982613948932990634861168043255995172576801608737*(p₆^2) +
              2567051787601182720/9189113952926808683*(p₇^2) +
              1993264703243531576278327994044089630720/4491504608408216105952756006100429555439*(p₈^2) +
              199852032189909863185822224447299328409352284781870286110720/594555383985694120793939288823813191906706790305448304076993*(p₉^2)
  let σ₁: ℝ := 13/47*(p₀'^2) + 611/1502*(p₁'^2) + 19526/57439*(p₂'^2) + 13/35*(p₃'^2)
  let σ₂: ℝ := 19/21*(p0^2) + 133/172*(p1^2) + 9804/15155*(p2^2) +19/35*(p3^2)
  have D₁: (γ₂ + 1) * I = -σ₀ - σ₁*g₁- σ₂*g₂  := by
    simp [h₁, h₂, h₃, h₄]
    linear_combination
  have l₀ : 0 ≤  σ₀ := by
    have : 0 ≤ (20347/4940 - (5119*x₂)/9880 - (186795895861880086941*x₁*x₂)/177982257273682001920 - (6915261268699158809*x₁^2)/11123891079605125120 - (5377573565036336819*x₂^2)/22247782159210250240
     - (2055412143171943019*x₃^2)/5134103575202365440 - (5133*x₁)/4940)^2:= by
      exact sq_nonneg p₀
    have : 0 ≤ ((94947649985174390338663*x₁)/22633781179672548081664 - (1043962647333088760401*x₂)/55713922903809349124096 - (665066924074234854900073*x₁*x₂)/724280997749521538613248 - (71248108088202699285825*x₁^2)/45267562359345096163328
     - (2913840292502817525901*x₂^2)/13928480725952337281024 - (14619064882856946399461*x₃^2)/17410600907440421601280)^ 2 := by
      exact sq_nonneg p₁
    have : 0 ≤ ((3035387511075596017978045764505982903416065737*x₂)/540767906150170158611719058258937491719454720 - (1538367546852829433170217707688776488242510603*x₁*x₂)/540767906150170158611719058258937491719454720 - (2424496975357762309072656492422565828372559*x₁^2)/6759598826877126982646488228236718646493184 - (284623448292816939944424948046145943904301819*x₂^2)/135191976537542539652929764564734372929863680
     - (12486145522545072336791255189450847838681337*x₃^2)/20278796480631380947939464684710155939479552) ^ 2 := by
        exact sq_nonneg p₂
    have : 0 ≤ ((61189676077769344494993168833732394858100705340993479129484897770451080223728611*x₁*x₂)/64027571717661770192180233687530786916719885898982413599294117521483982627143680 + (225205140540649012527639071898705809943286623822454203245384956530475527420133797*x₁^2)/76032741414723352103214027503942809463604864505041616149161764556762229369733120 - (2658315512190589720193100865284947829212390706650731036173110833671693613763737*x₂^2)/24010339394123163822067587632824045093769957212118405099735294070556493485178880 - (12872501674154348182357039491207146309261023031271713135450161317392617789721919*x₃^2)/152065482829446704206428055007885618927209729010083232298323529113524458739466240) ^ 2 := by
      exact sq_nonneg p₃
    have : 0 ≤ ((818646542448848242154864033313847154358805408743975824981699763958084758441506329069900103432107073*x₁*x₂)/4219212554006474231613710503426563785386085981920430657351322988300677848190896870099989418653777920 + (31775472113681667262342526975457701185571636717324566926967321513363892073427273283119097407383827653*x₂^2)/45092834170944193350371531005371400456313793931774602650442264437463494502540210299193636911862251520 - (46378661643104455497261928534669243919589538311450041891631364280630110149688259552530183354279447*x₃^2)/385408839067899088464713940216849576549690546425423954277284311431311918825130002557210571896258560) ^ 2 := by
      exact sq_nonneg p₄
    have : 0 ≤ ( (52762754918630813482299806445272923658536401770443073969646829703995248534424497788690376162987111676244893308895860091*x₁*x₂)/16966410758189995616700799728409721629303446320645701138732688013487800479192129521151198232059962893648721688715885281280 + (2047387167406990856798976232446496495686202722162191555120167667564934922683955470879733711191751337585566234572002677303*x₃^2)/1325500840483593407554749978782009502289331743800445401463491251053734412436885118839937361879684601066306381930928537600) ^ 2 := by
      exact sq_nonneg p₅
    have : 0 ≤ ((12774059214065658090915140639966325033301097042730934044821287658666127185366892864706554204862982613948932990634861168043255995172576801608737*x₁*x₂)^2/5381886861315929929147702423119713521436714503083845585293727755295089108026673235140993982199077146806906448443647584849515618149682999459840 ^ 2 ) := by
        rw [←div_pow]
        have : 0 ≤((12774059214065658090915140639966325033301097042730934044821287658666127185366892864706554204862982613948932990634861168043255995172576801608737*x₁*x₂)/5381886861315929929147702423119713521436714503083845585293727755295089108026673235140993982199077146806906448443647584849515618149682999459840) ^ 2 := by apply pow_two_nonneg
        linarith
    have : 0 ≤ ((9189113952926808683*x₃)/2567051787601182720 - (3590747131054856609*x₁*x₃)/1711367858400788480 - (7013940665610420363*x₂*x₃)/5561945539802562560) ^ 2 := by
      exact sq_nonneg p₇
    have : 0 ≤ ((2577979050391290598482504475072967441*x₁*x₃)/25554675682609379183055487103129354240 + (4491504608408216105952756006100429555439*x₂*x₃)/1993264703243531576278327994044089630720) ^ 2 := by
      exact sq_nonneg p₈
    have : ((594555383985694120793939288823813191906706790305448304076993*x₁*x₃)^ 2/199852032189909863185822224447299328409352284781870286110720 ^ 2)  ≥ 0 := by
        rw [←div_pow]
        have : 0 ≤((594555383985694120793939288823813191906706790305448304076993*x₁*x₃)/199852032189909863185822224447299328409352284781870286110720) ^ 2 := by apply pow_two_nonneg
        linarith
    simp
    linarith
  have l₁: 0 ≤ σ₁ := by
    have : 0 ≤ ((7*x₁)/13 + (10*x₂)/13 + 47/13)^2 := by apply pow_two_nonneg
    have : 0 ≤ ((1502*x₁)/611 - (211*x₂)/611) ^ 2 := by exact sq_nonneg p₁'
    have : 0 ≤ (57439*x₂)^ 2/19526 ^ 2  := by
     rw [←div_pow]
     have : 0 ≤((57439*x₂)/19526) ^ 2 := by apply pow_two_nonneg
     linarith
    have : 0 ≤ (35*x₃) ^ 2/13 ^ 2 := by
     rw [←div_pow]
     have : 0 ≤((35*x₃)/13) ^ 2 := by apply pow_two_nonneg
     linarith
    simp
    linarith
  have l₂: 0 ≤ σ₂ := by
    have : 0 ≤ (21/19 - (2*x₂)/19 - (3*x₁)/19) ^ 2 := by
        exact sq_nonneg p0
    have : 0 ≤ ((172*x₁)/133 - (23*x₂)/133) ^ 2 := by
        exact sq_nonneg p1
    have : 0 ≤ (15155*x₂) ^ 2/9804 ^ 2 := by
        rw [←div_pow]
        have : 0 ≤((15155*x₂)/9804) ^ 2 := by apply pow_two_nonneg
        linarith
    have : 0 ≤ (35*x₃)^ 2/19 ^ 2 := by
        rw [←div_pow]
        have : 0 ≤((35*x₃)/19) ^ 2 := by apply pow_two_nonneg
        linarith
    simp
    linarith
  rw [D₁]
  intro g
  have s₁ : 0 ≤ σ₁*g₁ := by
    exact Right.mul_nonneg l₁ g.left
  have s₂ : 0 ≤ σ₂*g₂  := by
    exact Right.mul_nonneg l₂ g.right
  linarith
