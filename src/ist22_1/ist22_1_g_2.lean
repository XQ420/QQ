import Mathlib.Tactic


theorem ist22_1_g_2(x₁ x₂: ℝ)
            (h₁ : g₁ = (2-x₁)*(x₁-1))
            (h₂ : g₂ = (2-x₂)*x₂)
            (h₃ : I = (7369*x₁)/865 - (2621*x₂)/173 - (35214*x₁^2*x₂^2)/865 - (2291*x₁*x₂)/865
                     - (15126*x₁*x₂^2)/865 + (4259*x₁^2*x₂)/173 + (25786*x₁*x₂^3)/865 + (17799*x₁^3*x₂)/865
                      - (3316*x₁^2)/865 - (11312*x₁^3)/865 + (30118*x₂^2)/865 - (792*x₁^4)/865 - (18863*x₂^3)/865 - (877*x₂^4)/865 - 3336/865)
              :
              0 ≤ g₁ ∧ 0 ≤ g₂
              → I ≤ 0 := by

  let p₀: ℝ := (115028133*x₁*x₂)/24570325 - (2698299*x₂)/982813 - (2968768*x₁)/258635 + (5956357*x₁^2)/5172700 - (38329763*x₂^2)/22680300 + 3154774/258635
  let p₁: ℝ := (29258086792452187*x₂)/4418287881448350 - (502446426775557*x₁)/77513822481550 + (1581751801688883*x₁*x₂)/294552525429890 - (108570746612799*x₁^2)/155027644963100 - (5230627584860501*x₂^2)/1178210101719560
  let p₂: ℝ := (35374316164921636938577*x₁)/7567165277565871384745 + (19740579388419063863280569*x₁*x₂)/5751045610950062252406200 - (524839120661445261648919*x₁^2)/151343305551317427694900 - (38296417794015957373766407*x₂^2)/17253136832850186757218600
  let p₃: ℝ := (62219173784881021352319059631737*x₁^2)/13037376672373173286692628912875 - (33485744358667792935198930063370151*x₁*x₂)/3170690006721155743323647351611200 + (243314064581544673724845977644977561*x₂^2)/47560350100817336149854710274168000
  let p₄: ℝ := (509839540547232773061066493205412568554714731*x₁*x₂)/1434793354521489992505222298963159989954558000 - (319941635723157163217705172510849308419772383*x₁^2)/956528903014326661670148199308773326636372000
  let p₅: ℝ := (7115807127063918818557367838234247684245513324532111*x₁^2)/801723085382155973424745509418705828382343758269284800

  let p₀': ℝ := 1247/299 - (458*x₂)/299 - (144*x₁)/299
  let p₁': ℝ := (729227*x₂)/372853 - (2048543*x₁)/745706
  let p₂': ℝ := (2355840153*x₁)/872155492

  let p0: ℝ :=3585/494 - (343*x₂)/52 - x₁/494
  let p1: ℝ :=(16795931*x₂)/7083960 - (5441377*x₁)/3541980
  let p2: ℝ :=(525248077*x₁)/8297189914

  let δ₀: ℝ := 258635/3154774*(p₀^2) +
      4418287881448350/29258086792452187*(p₁^2) +
      7567165277565871384745/35374316164921636938577*(p₂^2) +
      47560350100817336149854710274168000/243314064581544673724845977644977561*(p₃^2) +
      1434793354521489992505222298963159989954558000/509839540547232773061066493205412568554714731*(p₄^2) +
      801723085382155973424745509418705828382343758269284800/7115807127063918818557367838234247684245513324532111*(p₅^2)
  let δ₁: ℝ := 299/1247*(p₀'^2) + 372853/729227*(p₁'^2) + 872155492/2355840153*(p₂'^2)
  let δ₂: ℝ := 494/3585*(p0^2) + 7083960/16795931*(p1^2) + 8297189914/525248077*(p2^2)
  have h1 :258635/3154774*(p₀^2) +
      4418287881448350/29258086792452187*(p₁^2) +
      7567165277565871384745/35374316164921636938577*(p₂^2) +
      47560350100817336149854710274168000/243314064581544673724845977644977561*(p₃^2) +
      1434793354521489992505222298963159989954558000/509839540547232773061066493205412568554714731*(p₄^2) +
      801723085382155973424745509418705828382343758269284800/7115807127063918818557367838234247684245513324532111*(p₅^2)= δ₀ := by exact rfl
  have h2 : 299/1247*(p₀'^2) + 372853/729227*(p₁'^2) + 872155492/2355840153*(p₂'^2) = δ₁ := by  exact rfl
  have h3 : 494/3585*(p0^2) + 7083960/16795931*(p1^2) + 8297189914/525248077*(p2^2) = δ₂ := by  exact rfl
  have I₁: I = -δ₀ - δ₁*g₁- δ₂*g₂  := by
    rw [h₁, h₂, h₃]
    linear_combination
  have l₀ : δ₀ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁
    have : p₂ ^ 2  ≥ 0 := by
        exact sq_nonneg p₂
    have : p₃ ^ 2  ≥ 0 := by
      exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
      exact sq_nonneg p₅
    linarith
  have l₁: 0 ≤ δ₁ := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    linarith
  have l₂: 0 ≤ δ₂ := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    linarith
  rw [I₁]
  intro g
  have s₁ : 0 ≤ δ₁*g₁ := by
    exact Right.mul_nonneg l₁ g.left
  have s₂ : 0 ≤ δ₂*g₂  := by
    exact Right.mul_nonneg l₂ g.right
  linarith
