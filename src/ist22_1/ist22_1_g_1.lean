import Mathlib.Tactic


theorem ist22_1_g_1  (x₁ x₂: ℝ)
            (h₁ : g₁ = (1-x₁)*(x₁+1))
            (h₂ : g₂ = (3-x₂)*x₂)
            (h₃ : I = (7369*x₁)/865 - (2621*x₂)/173 - (35214*x₁^2*x₂^2)/865 - (2291*x₁*x₂)/865
                     - (15126*x₁*x₂^2)/865 + (4259*x₁^2*x₂)/173 + (25786*x₁*x₂^3)/865 + (17799*x₁^3*x₂)/865
                      - (3316*x₁^2)/865 - (11312*x₁^3)/865 + (30118*x₂^2)/865 - (792*x₁^4)/865 - (18863*x₂^3)/865 - (877*x₂^4)/865 - 3336/865)
              :
              0 ≤ g₁ ∧ 0 ≤ g₂
              → I ≤ 0 := by

  let p₀: ℝ := (149321*x₂)/152240 - (38159*x₁)/10380 + (21987169*x₁*x₂)/4567200 + (23831*x₁*x₂^2)/2283600 + (4040401*x₁^2*x₂)/6850800 - (510859*x₁^2)/155700 + (84553*x₁^3)/69200 - (14888567*x₂^2)/3425400 + (7702403*x₂^3)/9134400 + 10057/3460
  let p₁: ℝ := (6555716976859*x₂)/3031533806400 - (29182931353*x₁)/45932330400 + (131998515701*x₁*x₂)/673674179200 - (952875387569*x₁*x₂^2)/3031533806400 + (19943552916409*x₁^2*x₂)/21220736644800 - (494281968*x₁^2)/478461775 - (12353779913*x₁^3)/91864660800 - (4183727109559*x₂^2)/3031533806400 + (3082754076143*x₂^3)/12126135225600
  let p₂: ℝ := (389488838115426423*x₁)/90731122959728560 - (474976581192315788371*x₁*x₂)/179647623460262548800 + (754318143506359520489*x₁*x₂^2)/628766682110918920800 - (46575945025965501361*x₁^2*x₂)/58946876447898648825 + (10272010260313925809*x₁^2)/12248701599563355600 - (17175863798422463947*x₁^3)/8165801066375570400 - (129972137011360571209*x₂^2)/269471435190393823200 + (6032961661886771489*x₂^3)/119765082306841699200
  let p₃: ℝ := (12366488285723380269358205029*x₁^2)/15129318449353796130363228000 - (66407968693569905305677127273*x₁*x₂^2)/110948335295261171622663672000 - (52930350796849877556134039279*x₁^2*x₂)/332845005885783514867991016000 - (14055188117807714225961483427*x₁*x₂)/3169952437007462046361819200 + (810983537372193143112572557*x₁^3)/720443735683514101445868000 + (1112706083913462522132517211*x₂^2)/297183040969449566846420550 - (6455389272313836205937747681*x₂^3)/10566508123358206821206064000
  let p₄: ℝ := (4389430018376148779101587366324445379*x₁*x₂)/975734635478316677968057460367206400 - (27001904251406861765049656428907475119*x₁*x₂^2)/34150712241741083728882011112852224000 - (28899865159256904434455282109468216579*x₁^2*x₂)/34150712241741083728882011112852224000 - (20146487050210179947149155330757175461*x₁^2)/17075356120870541864441005556426112000 - (314247427963603538225919001789250029*x₁^3)/221757871699617426810922150083456000 - (1370241099183118873699275301892557709*x₂^3)/9757346354783166779680574603672064000
  let p₅: ℝ := (1910078731365417848716583202522407816290971248329*x₁^2)/1031438975927272277916312007212092006804144760000 - (3633260668239939075375587841751729043035676610629*x₁^2*x₂)/2062877951854544555832624014424184013608289520000 - (150426163808454441777073855559790084358651127383*x₁*x₂^2)/687625983951514851944208004808061337869429840000 + (1842459348470014656155832597778947515095858529*x₁^3)/3348827843919715188039974049389909113000470000 + (58363660080698044782087921824066154779576497763*x₂^3)/294696850264934936547517716346312001944041360000
  let p₆: ℝ := (18541633586231345730270723687336331014067678152550131617*x₁^2*x₂)/122131962146489909581217303235844773699897734395154923200 - (493061950018436558750286476636762358108045224249000278951*x₁*x₂^2)/732791772878939457487303819415068642199386406370929539200 + (15243922838817373547550995880663897309245444204001839321*x₁^3)/104684538982705636783900545630724091742769486624418505600 + (12056088635081030229263213477728611619673852435616898793*x₂^3)/52342269491352818391950272815362045871384743312209252800
  let p₇: ℝ := (141006613414818674988933452488387875671093210462250439373871433*x₁*x₂^2)/370020457055034786087971174561639812728596094631340641124858112 - (82739242762526742027164569129517593968402234575982766500983125*x₁^2*x₂)/92505114263758696521992793640409953182149023657835160281214528 + (206274552403097353944244556967412483801366506253668527227808557*x₁^3)/3083503808791956550733093121346998439404967455261172009373817600
  let p₈: ℝ := (67742737005254203754584446352310376062797955416083595431791885644168187*x₁^2*x₂)/189337589007718996608380318076259741094914971782017920772253608986494400 - (25394405865247876938779866603868342621261604695006282578335671152759141*x₁^3)/54096454002205427602394376593217068884261420509147977363501031138998400
  let p₉: ℝ := (11560448506515991771526033331014239825890665335921639896606892548892225921171*x₁^3)/26922274835636509363112270292273026873989380991166125668376646165682324640000


  let p₀': ℝ := x₂/10 - (7*x₁)/12 - (19*x₁*x₂)/600 - (23*x₁^2)/450 - (103*x₂^2)/180 + 19/20
  let p₁': ℝ := (3821*x₂)/3420 - (533*x₁)/3800 - (83*x₁*x₂)/300 - (8081*x₁^2)/34200 - (4091*x₂^2)/6840
  let p₂': ℝ := (44547343*x₁)/22926000 - (3296003*x₁*x₂)/34389000 - (127799459*x₁^2)/206334000 - (4510063*x₂^2)/8253360
  let p₃': ℝ := (36724310627*x₂^2)/43300017396 - (869172221629*x₁^2)/2165000869800 - (4949215055*x₁*x₂)/7216669566
  let p₄': ℝ := (103648104293423*x₁*x₂)/73448621254000 - (24742098688591*x₁^2)/36724310627000
  let p₅': ℝ := (8980559782938804877*x₁^2)/3109443128802690000



  let p0: ℝ :=(789*x₁*x₂)/2200 - (89*x₂)/22 - (81*x₁)/176 - (507*x₁^2)/440 + (3647*x₂^2)/4400 + 381/88
  let p1: ℝ :=(1523611*x₂)/1676400 - (87003*x₁)/279400 - (36629*x₁*x₂)/223520 - (43899*x₁^2)/279400 - (1070461*x₂^2)/3352800
  let p2: ℝ :=(14642855397*x₁)/13407776800 - (237219511*x₁*x₂)/304722200 - (4763713959*x₁^2)/13407776800 + (160546121*x₂^2)/1340777680
  let p3: ℝ :=(7903044891311*x₁^2)/107380939578000 - (4088782011391459*x₁*x₂)/6442856374680000 + (2233833161738359*x₂^2)/6442856374680000
  let p4: ℝ :=(22614471409754573179*x₁*x₂)/58973195469892677600 - (29001182318808107327*x₁^2)/58973195469892677600
  let p5: ℝ :=(35751901620006974507201*x₁^2)/149255511304380182981400

  let δ₀: ℝ := 3460/10057*(p₀^2) +
      3031533806400/6555716976859*(p₁^2) +
      90731122959728560/389488838115426423*(p₂^2) +
      297183040969449566846420550/1112706083913462522132517211*(p₃^2) +
      975734635478316677968057460367206400/4389430018376148779101587366324445379*(p₄^2) +
      1031438975927272277916312007212092006804144760000/1910078731365417848716583202522407816290971248329*(p₅^2) +
      52342269491352818391950272815362045871384743312209252800/12056088635081030229263213477728611619673852435616898793*(p₆^2) +
      370020457055034786087971174561639812728596094631340641124858112/141006613414818674988933452488387875671093210462250439373871433*(p₇^2) +
      189337589007718996608380318076259741094914971782017920772253608986494400/67742737005254203754584446352310376062797955416083595431791885644168187*(p₈^2) +
      26922274835636509363112270292273026873989380991166125668376646165682324640000/11560448506515991771526033331014239825890665335921639896606892548892225921171*(p₉^2)
  let δ₁: ℝ := 20/19*(p₀'^2) + 3420/3821*(p₁'^2) + 22926000/44547343*(p₂'^2) + 43300017396/36724310627*(p₃'^2) + 73448621254000/103648104293423*(p₄'^2) + 3109443128802690000/8980559782938804877*(p₅'^2)
  let δ₂: ℝ := 88/381*(p0^2) + 1676400/1523611*(p1^2) + 13407776800/14642855397*(p2^2) + 6442856374680000/2233833161738359*(p3^2) + 58973195469892677600/22614471409754573179*(p4^2) + 149255511304380182981400/35751901620006974507201*(p5^2)
  have h1 :3460/10057*(p₀^2) +
      3031533806400/6555716976859*(p₁^2) +
      90731122959728560/389488838115426423*(p₂^2) +
      297183040969449566846420550/1112706083913462522132517211*(p₃^2) +
      975734635478316677968057460367206400/4389430018376148779101587366324445379*(p₄^2) +
      1031438975927272277916312007212092006804144760000/1910078731365417848716583202522407816290971248329*(p₅^2) +
      52342269491352818391950272815362045871384743312209252800/12056088635081030229263213477728611619673852435616898793*(p₆^2) +
      370020457055034786087971174561639812728596094631340641124858112/141006613414818674988933452488387875671093210462250439373871433*(p₇^2) +
      189337589007718996608380318076259741094914971782017920772253608986494400/67742737005254203754584446352310376062797955416083595431791885644168187*(p₈^2) +
      26922274835636509363112270292273026873989380991166125668376646165682324640000/11560448506515991771526033331014239825890665335921639896606892548892225921171*(p₉^2)= δ₀ := by exact rfl
  have h2 : 20/19*(p₀'^2) + 3420/3821*(p₁'^2) + 22926000/44547343*(p₂'^2) + 43300017396/36724310627*(p₃'^2) + 73448621254000/103648104293423*(p₄'^2) + 3109443128802690000/8980559782938804877*(p₅'^2)= δ₁ := by  exact rfl
  have h3 : 88/381*(p0^2) + 1676400/1523611*(p1^2) + 13407776800/14642855397*(p2^2) + 6442856374680000/2233833161738359*(p3^2) + 58973195469892677600/22614471409754573179*(p4^2) + 149255511304380182981400/35751901620006974507201*(p5^2)= δ₂ := by  exact rfl
  have I₁: I = -δ₀ - δ₁*g₁- δ₂*g₂  := by
    rw [h₁,h₂,h₃]
    linear_combination
  have l₀ : δ₀ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁
    have : p₂ ^ 2  ≥ 0 := by
        exact sq_nonneg p₂
    have : p₃ ^ 2  ≥ 0 := by
      exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
      exact sq_nonneg p₅
    have : p₆ ^ 2  ≥ 0 := by
        exact sq_nonneg p₆
    have : p₇ ^ 2  ≥ 0 := by
      exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
      exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
      exact sq_nonneg p₉
    linarith
  have l₁: 0 ≤ δ₁ := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    have : p₄' ^ 2 ≥ 0 := by
      exact sq_nonneg p₄'
    have : p₅' ^ 2 ≥ 0 := by
      exact sq_nonneg p₅'
    linarith
  have l₂: 0 ≤ δ₂ := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    have : p4 ^ 2  ≥ 0 := by
        exact sq_nonneg p4
    have : p5 ^ 2 ≥ 0 := by
        exact sq_nonneg p5
    linarith
  rw [I₁]
  intro g
  have s₁ : 0 ≤ δ₁*g₁ := by
    exact Right.mul_nonneg l₁ g.left
  have s₂ : 0 ≤ δ₂*g₂  := by
    exact Right.mul_nonneg l₂ g.right
  linarith
