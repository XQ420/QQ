import Mathlib.Tactic


theorem cav20_4_2 (x₁ x₂ x₅ x₆: ℝ)
             (h₁ : f₃ = 16-16*(x₁+x₂)^2-(x₁-x₂-4)^2-x₅^2)
             (h₂ : f₄ = x₁-x₂-x₆^2-(1-x₆)^2)
             (h₃ : I = x₁/51 + (4*x₂)/51 - (35* x₁*x₂)/17 - (2* x₁^2)/51 - x₂^2/51 + 46/51):
              0 ≤ f₃ ∧ 0 ≤ f₄
                →  I > 0 := by

  let p₀: ℝ :=(54287* x₂)/186558 - (48151*x₁)/186558 - (7*x₆)/62 - (14051*x₁* x₂)/200600 + (x₁*x₆)/36580 - (547* x₂*x₆)/45725 + (267061*x₁^2)/5596740 + (8099* x₂^2)/118575 - (7174*x₅^2)/137175 - (127*x₆^2)/3100 + 15788419/15810000
  let p₁: ℝ :=(2687561852310499*x₁)/2606728446544770 - (5645068868448197* x₂)/17378189643631800 + (40916975121*x₆)/577540367020 - (2198026430961003*x₁* x₂)/5792729881210600 - (419873286171*x₁*x₆)/34074881654180 - (883878864001* x₂*x₆)/20444928992508 - (115648583080292*x₁^2)/260672844654477 - (31496912024522* x₂^2)/110454595192575 - (1307537229347*x₅^2)/20444928992508 - (92777808891*x₆^2)/577540367020
  let p₂: ℝ :=(127617281704944872048927* x₂)/176959822603532496156000 - (557953893216897337*x₆)/33325766968650187600 + (6033194907148037185467*x₁* x₂)/334257442695561381628000 - (731614250821816934939*x₁*x₆)/5898660753451083205200 - (215157814942703044143* x₂*x₆)/1966220251150361068400 - (756155367049114061807*x₁^2)/150415849213002621732600 + (19006255750520156829473* x₂^2)/94009905758126638582875 + (5953746767295774173*x₅^2)/190279379143583329200 + (2045504894153118539*x₆^2)/33325766968650187600
  let p₃: ℝ :=(89212973585713722435798989*x₆)/197806786642664551675836850 - (114020422452599436222320865919*x₁* x₂)/595200621007777635992593081650 - (243142141734109912966701911*x₁*x₆)/4668240164766883419549749660 + (462774308615052093198979173* x₂*x₆)/4668240164766883419549749660 - (1822858422818521809150202351*x₁^2)/23808024840311105439703723266 - (183991591467839847066308376071* x₂^2)/2380802484031110543970372326600 - (27027594090232978989172339*x₅^2)/23341200823834417097748748300 - (3035509566304349823879284*x₆^2)/19780678664266455167583685
  let p₄: ℝ :=(1583263405844844735957781991163797407*x₁* x₂)/5007997232394657411620496345969475800 - (55788667663242756168339065024042*x₁*x₆)/350700086302146877564460528429235 - (62868718392359427445137175116457* x₂*x₆)/527935613788178095258327677205300 + (138990415933324131477537323796748078*x₁^2)/375599792429599305871537225947710685 - (453210918958283462646401635613767087* x₂^2)/15023991697183972234861489037908427400 - (318278788066810255983930363447887*x₅^2)/73647018123450844288536710970139350 + (2133850244319372184957645209017*x₆^2)/83216969631017903150888938949310
  let p₅: ℝ :=(805764524368034733752225289535154323425159*x₁* x₂)/2033707765936398691779326121794017877296000 - (893069368015118563149083941620813496257*x₁*x₆)/50842694148409967294483153044850446932400 + (27268976912456190650421436675087786990853* x₂*x₆)/1016853882968199345889663060897008938648000 + (2564617965821228329677831924629516278993141* x₂^2)/6101123297809196075337978365382053631888000 - (1401209888468405981701153710155047143473*x₅^2)/508426941484099672944831530448504469324000 + (10797054682243783188693472675217779857883*x₆^2)/305056164890459803766898918269102681594400
  let p₆: ℝ :=(55883291044588355691441917563105920909816959557*x₁* x₂)/5628823511384431937976905508176862329134145866800 - (1618793722510021626013208044873829038181809473*x₁*x₆)/938137251897405322996150918029477054855690977800 + (224753721724577165847402908191322733575253993* x₂*x₆)/469068625948702661498075459014738527427845488900 + (8268856614403722310969680646282335913877937663*x₅^2)/938137251897405322996150918029477054855690977800 - (1816815036520859965598750624111891066715146852*x₆^2)/351801469461526996123556594261053895570884116675
  let p₇: ℝ :=(604425231416757837635269594349281312518008812777439*x₁* x₂)/27222729745939934592174382623690706295668946374128600 - (15048804295769226571962186364280215455988127000431*x₁*x₆)/504124624924813603558784863401679746216091599520900 + (21219300260941746694101849336300869285024102910957* x₂*x₆)/504124624924813603558784863401679746216091599520900 + (1130642747125840331848558797799969072332988346190071*x₆^2)/6805682436484983648043595655922676573917236593532150
  let p₈: ℝ :=(795708886491971450329239055986681345509945618470222501673*x₁* x₂)/14889208208350766162047301096468232719738656933307806984800 - (1128788024165066157437317148899679755447428596572266211*x₁*x₆)/496306940278358872068243369882274423991288564443593566160 - (15420424097872454041254729127728401928670083260345184593* x₂*x₆)/827178233797264786780405616470457373318814274072655943600
  let p₉: ℝ :=(515509025638263380261223548783015719785293625667195361045539*x₁*x₆)/1408404729090789467082753129096425981552603744692293827961210 + (4209897141293248380753983680149873534995726885170300449471633* x₂*x₆)/14553515533938157826521782333996401809376905361820369555599170
  let p₁₀: ℝ :=(623657848125068398023550484232257478296135589199681876006395042679* x₂*x₆)/4384326936699584309614667098867231244415954492255646466388152364150
  let p₁₁: ℝ :=(25748*x₅)/137175 - (369*x₁*x₅)/7316 + (10279* x₂*x₅)/182900 - (7383*x₅*x₆)/182900
  let p₁₂: ℝ :=(227669571* x₂*x₅)/18837236800 - (277213*x₁*x₅)/18377792 + (4000490951*x₅*x₆)/56511710400
  let p₁₃: ℝ :=(350911866960751*x₁*x₅)/1463379589875800 + (95773628008299* x₂*x₅)/365844897468950
  let p₁₄: ℝ :=(200076992146462231*x₁*x₅)/4520515241991712800


  let p₀': ℝ := x₂/118 - x₁/59 - x₆/118 + 3/59
  let p₁': ℝ :=(5*x₁)/177 +  x₂/354 - (2*x₆)/177
  let p₂': ℝ :=(19* x₂)/590 + (3*x₆)/1180
  let p₃': ℝ :=(249*x₆)/8968
  let p₄': ℝ :=x₅/59

  let p0: ℝ := 3/31 - x₆/62 - x₁/62
  let p1: ℝ := (23*x₁)/372 +  x₂/62 - (7*x₆)/372
  let p2: ℝ := (43* x₂)/713 + (7*x₆)/1426
  let p3: ℝ := (641*x₆)/5332
  let p4: ℝ := x₅/31

  let ε: ℝ :=  1/10000
  let σ₀₂: ℝ :=15810000/15788419*(p₀^2) + 2606728446544770/2687561852310499*(p₁^2) +176959822603532496156000/127617281704944872048927*(p₂^2) + 197806786642664551675836850/89212973585713722435798989*(p₃^2) +
      375599792429599305871537225947710685/138990415933324131477537323796748078*(p₄^2) + 6101123297809196075337978365382053631888000/2564617965821228329677831924629516278993141*(p₅^2) + 938137251897405322996150918029477054855690977800/8268856614403722310969680646282335913877937663*(p₆^2) +
      6805682436484983648043595655922676573917236593532150/1130642747125840331848558797799969072332988346190071 *(p₇^2) + 14889208208350766162047301096468232719738656933307806984800/795708886491971450329239055986681345509945618470222501673 *(p₈^2) +
      1408404729090789467082753129096425981552603744692293827961210/515509025638263380261223548783015719785293625667195361045539 *(p₉^2) + 4384326936699584309614667098867231244415954492255646466388152364150/623657848125068398023550484232257478296135589199681876006395042679 *(p₁₀^2) +
      137175/25748 *(p₁₁^2) + 56511710400/4000490951 *(p₁₂^2) + 365844897468950/95773628008299 *(p₁₃^2) + 4520515241991712800/200076992146462231*(p₁₄^2)
  let σ₂₁: ℝ := 59/3*(p₀'^2) + 177/5*(p₁'^2) + 590/19*(p₂'^2) +8968/249*(p₃'^2) +  59*(p₄'^2)
  let σ₂₂: ℝ :=31/3*(p0^2) + 372/23*(p1^2) + 713/43*(p2^2) + 5332/641*(p3^2) + 31*(p4^2)
  have h1 :15810000/15788419*(p₀^2) + 2606728446544770/2687561852310499*(p₁^2) + 176959822603532496156000/127617281704944872048927*(p₂^2) +  197806786642664551675836850/89212973585713722435798989*(p₃^2) +
      375599792429599305871537225947710685/138990415933324131477537323796748078*(p₄^2) + 6101123297809196075337978365382053631888000/2564617965821228329677831924629516278993141*(p₅^2) + 938137251897405322996150918029477054855690977800/8268856614403722310969680646282335913877937663*(p₆^2) +
      6805682436484983648043595655922676573917236593532150/1130642747125840331848558797799969072332988346190071 *(p₇^2) +  14889208208350766162047301096468232719738656933307806984800/795708886491971450329239055986681345509945618470222501673 *(p₈^2) +
      1408404729090789467082753129096425981552603744692293827961210/515509025638263380261223548783015719785293625667195361045539 *(p₉^2) + 4384326936699584309614667098867231244415954492255646466388152364150/623657848125068398023550484232257478296135589199681876006395042679 *(p₁₀^2) +
      137175/25748 *(p₁₁^2) + 56511710400/4000490951 *(p₁₂^2) + 365844897468950/95773628008299 *(p₁₃^2) + 4520515241991712800/200076992146462231*(p₁₄^2)= σ₀₂ := by exact rfl
  have h2 : 59/3*(p₀'^2) + 177/5*(p₁'^2) + 590/19*(p₂'^2) +8968/249*(p₃'^2) + 59*(p₄'^2) = σ₂₁ := by exact rfl
  have h3 : 31/3*(p0^2) +  372/23*(p1^2) + 713/43*(p2^2) +  5332/641*(p3^2) + 31*(p4^2) = σ₂₂ := by exact rfl
  have D₁: I = σ₀₂ + σ₂₁*f₃ + σ₂₂*f₄ + ε := by
    rw [h₁, h₂, h₃]
    linear_combination
  have l₀: σ₀₂ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
          exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁
    have : p₂ ^ 2 ≥ 0 := by
          exact sq_nonneg p₂
    have : p₃ ^ 2 ≥ 0 := by
          exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
          exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
          exact sq_nonneg p₅
    have : p₆ ^ 2 ≥ 0 := by
          exact sq_nonneg p₆
    have : p₇ ^ 2 ≥ 0 := by
          exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
          exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
          exact sq_nonneg p₉
    have : p₁₀ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₀
    have : p₁₁ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₁
    have : p₁₂ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₂
    have : p₁₃ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₃
    have : p₁₄ ^ 2 ≥ 0 := by
          exact sq_nonneg p₁₄
    linarith
  have l₁: σ₂₁ ≥ 0 := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    have : p₄' ^ 2 ≥ 0 := by
      exact sq_nonneg p₄'
    linarith
  have l₂: σ₂₂ ≥ 0 := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    have : p4 ^ 2 ≥ 0 := by
        exact sq_nonneg p4
    linarith
  rw [D₁]
  intro f
  have h5 : ε >  0 := by norm_num
  have s₁ : 0 ≤ σ₂₁*f₃ := by
    exact Right.mul_nonneg l₁ f.left
  have s₂ : 0 ≤ σ₂₂*f₄  := by
    exact Right.mul_nonneg l₂ f.right
  linarith
