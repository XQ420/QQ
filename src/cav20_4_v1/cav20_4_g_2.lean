import Mathlib.Tactic


theorem cav20_4_4 (x₁ x₂ x₅ x₆: ℝ)
            (h₁ : g₃=16-(x₁+x₂+4)^2-16*(x₁-x₂)^2-x₅^2)
            (h₂ : g₄=-x₁-x₂-x₆^2-(2-x₆)^2)
            (h₃ : I = x₁/51 + (4*x₂)/51 - (35* x₁*x₂)/17 - (2* x₁^2)/51 - x₂^2/51 + 46/51)
              :
              0 ≤ g₃ ∧ 0 ≤ g₄
              → I ≤ 0 := by

  let p₀: ℝ :=(94607*x₁)/252960 + (87167*x₂)/252960 - (3*x₆)/8 - (235567*x₁*x₂)/1264800 + (799*x₁*x₆)/37200 + (799*x₂*x₆)/37200 + (4745*x₁^2)/25296 + (356123*x₂^2)/1897200 + (5*x₅^2)/279 + (49*x₆^2)/600 + 661/1020
  let p₁: ℝ :=(12740588229*x₁)/13822408960 + (40405888931*x₂)/207336134400 + (24382699*x₆)/98356800 - (2782009181*x₁*x₂)/13822408960 - (255731717*x₁*x₆)/1219624320 + (3994373021*x₂*x₆)/18294364800 + (6149218237*x₁^2)/20733613440 + (49111049933*x₂^2)/311004201600 + (138529379*x₅^2)/4573591200 + (7672813*x₆^2)/49178400
  let p₂: ℝ :=(6350515309727047*x₂)/7109248231782000 + (20464033722107*x₆)/114665294061000 - (2774353736621569*x₁*x₂)/16114295992039200 + (187432716864451*x₁*x₆)/710924823178200 - (679472719956649*x₂*x₆)/2665968086918250 + (9551985325580171*x₁^2)/96685775952235200 + (393954462199349731*x₂^2)/1450286639283528000 + (316699733041559*x₅^2)/10663872347673000 + (15105935314873*x₆^2)/114665294061000
  let p₃: ℝ :=(7342507821229744043*x₆)/11430927557508684600 + (6764906352253091427149*x₁*x₂)/12048197645614153568400 + (1098753620253548233*x₁*x₆)/18528562315438913600 + (363817369362678450763*x₂*x₆)/8504610102786461342400 - (17855980631922931043*x₁^2)/71929538182771066080 - (17740069298708124148111*x₂^2)/72289185873684921410400 - (4743387801498091543*x₅^2)/1063076262848307667800 - (9053840234238503179*x₆^2)/22861855115017369200
  let p₄: ℝ :=(36513119392668648121757727*x₁*x₆)/153541824352550820391028480 - (1111747356307589834569195739*x₁*x₂)/2349189912594027551982735744 - (909571112172500194986475981*x₂*x₆)/6909382095864786917596281600 + (743272413482879281067701157*x₁^2)/1566126608396018367988490496 + (199593483673587902617994117*x₂^2)/4698379825188055103965471488 + (57382009979677643953103*x₅^2)/28789092066103278823317840 - (7532161870524902219249*x₆^2)/55720823353748281593518400
  let p₅: ℝ :=(78603608243752308453393687754441*x₂*x₆)/321093682624603849421246899824000 - (54928997375435886190329493284947*x₁*x₆)/368663117087508123409579773872000 - (713854413461679364672281197549917*x₁*x₂)/1658984026893786555343108982424000 + (129841838694426340589879045118007*x₂^2)/276497337815631092557184830404000 + (31912689657551765562230620979*x₅^2)/49769520806813596660293269472720 - (32752540611799327510263590207*x₆^2)/80273420656150962355311724956000
  let p₆: ℝ :=(25809544345575317844089800439187783139*x₂*x₆)/3912394283540454494654235387495786924000 - (71757723295297179321516869322851383*x₁*x₆)/28980698396595959219661002870339162400 - (920415190441300095558627681420169883*x₁*x₂)/130413142784681816488474512916526230800 + (402690818201850210068463415380445277*x₅^2)/48904928544255681183177942343697336550 - (3224771475811738728918348635764088677*x₆^2)/489049285442556811831779423436973365500
  let p₇: ℝ :=(313261829665604581677956276822411220809*x₁*x₆)/3994692916562354083879157080574017147840 - (225164714402472335724539349238127137219*x₁*x₂)/16050105468330886944157327555877747469000 + (358425970280209307873713461192317001029281*x₂*x₆)/4494029531132648344364051715645769291320000 + (12612609728508434932909374450900774409501*x₆^2)/46812807615965086920458872037976763451250
  let p₈: ℝ :=(1149668993760882371219397280303920385491253387*x₁*x₂)/16890806948418496062152234264646317089203739200 + (1779024872208464982297923252622719705622381*x₁*x₆)/80720702262453983570619996485764956220806400 + (2640639489494763645966755779238627249644415*x₂*x₆)/87178358443450302256269596204626152718470912
  let p₉: ℝ :=(17805418264392073936553592173643863951382360677899*x₁*x₆)/58863052480557177406433140751560723737152173414400 - (1227050651364004273561950398869795742691600887701229*x₂*x₆)/5474263880691817498798282089895147307555152127539200
  let p₁₀: ℝ :=(96631401485907023264021506267653537897877923579727890347*x₂*x₆)/739195500329889827890809689807259740714428980015112564800
  let p₁₁: ℝ :=(887*x₅)/2790 + (3767*x₁*x₅)/74400 + (679*x₂*x₅)/14880 - (397*x₅*x₆)/2325
  let p₁₂: ℝ :=(6198407*x₁*x₅)/164982000 + (986089*x₂*x₅)/32996400 + (11904857*x₅*x₆)/123736500
  let p₁₃: ℝ :=(784646263469*x₂*x₅)/4723847257600 - (73124535899*x₁*x₅)/457146508800
  let p₁₄: ℝ :=(451802905559021*x₁*x₅)/87566523003140400


  let p₀': ℝ :=x₁/93 + x₂/93 - (2*x₆)/93 + 5/93
  let p₁': ℝ :=(19*x₁)/465 - (2*x₂)/155 + (7*x₆)/465
  let p₂': ℝ :=(65*x₂)/1767 + (35*x₆)/1767
  let p₃': ℝ :=(35*x₆)/1209
  let p₄': ℝ :=x₅/93

  let p0: ℝ :=x₆/10 - x₂/160 - x₁/160 + 31/80
  let p1: ℝ :=(991*x₁)/9920 - (87*x₂)/1984 + (33*x₆)/1240
  let p2: ℝ :=(3197*x₂)/39640 + (759*x₆)/19820
  let p3: ℝ :=(2629*x₆)/11120
  let p4: ℝ :=(3*x₅)/40


  let δ₀₂: ℝ :=1020/661*(p₀^2) +  13822408960/12740588229*(p₁^2) +  7109248231782000/6350515309727047*(p₂^2) +  11430927557508684600/7342507821229744043*(p₃^2) + 1566126608396018367988490496/743272413482879281067701157*(p₄^2) +
      276497337815631092557184830404000/129841838694426340589879045118007*(p₅^2) +  48904928544255681183177942343697336550/402690818201850210068463415380445277*(p₆^2) +  46812807615965086920458872037976763451250/12612609728508434932909374450900774409501*(p₇^2) +
      16890806948418496062152234264646317089203739200/1149668993760882371219397280303920385491253387*(p₈^2) +  58863052480557177406433140751560723737152173414400/17805418264392073936553592173643863951382360677899*(p₉^2) +
      739195500329889827890809689807259740714428980015112564800/96631401485907023264021506267653537897877923579727890347*(p₁₀^2) +  2790/887*(p₁₁^2) +
      123736500/11904857*(p₁₂^2) +  4723847257600/784646263469*(p₁₃^2) +  87566523003140400/451802905559021*(p₁₄^2)
  let δ₂₁: ℝ :=93/5*(p₀'^2) + 465/19*(p₁'^2) + 1767/65*(p₂'^2) + 1209/35*(p₃'^2) + 93*(p₄'^2)
  let δ₂₂: ℝ :=80/31*(p0^2) + 9920/991*(p1^2) + 39640/3197*(p2^2) + 11120/2629*(p3^2) + 40/3*(p4^2)
  have h1 :1020/661*(p₀^2) +  13822408960/12740588229*(p₁^2) +  7109248231782000/6350515309727047*(p₂^2) +  11430927557508684600/7342507821229744043*(p₃^2) + 1566126608396018367988490496/743272413482879281067701157*(p₄^2) +
      276497337815631092557184830404000/129841838694426340589879045118007*(p₅^2) +  48904928544255681183177942343697336550/402690818201850210068463415380445277*(p₆^2) +  46812807615965086920458872037976763451250/12612609728508434932909374450900774409501*(p₇^2) +
      16890806948418496062152234264646317089203739200/1149668993760882371219397280303920385491253387*(p₈^2) +  58863052480557177406433140751560723737152173414400/17805418264392073936553592173643863951382360677899*(p₉^2) +
      739195500329889827890809689807259740714428980015112564800/96631401485907023264021506267653537897877923579727890347*(p₁₀^2) +  2790/887*(p₁₁^2) +
      123736500/11904857*(p₁₂^2) +  4723847257600/784646263469*(p₁₃^2) +  87566523003140400/451802905559021*(p₁₄^2) = δ₀₂ := by exact rfl
  have h2 :93/5*(p₀'^2) + 465/19*(p₁'^2) + 1767/65*(p₂'^2) + 1209/35*(p₃'^2) + 93*(p₄'^2) = δ₂₁ := by  exact rfl
  have h3 :80/31*(p0^2) + 9920/991*(p1^2) + 39640/3197*(p2^2) + 11120/2629*(p3^2) + 40/3*(p4^2)= δ₂₂ := by  exact rfl
  have D₁: I = -δ₀₂ - δ₂₁*g₃- δ₂₂*g₄:= by
    rw  [h₁, h₂, h₃]
    linear_combination
  have l₀ : δ₀₂ ≥ 0 := by
    rw [← h1]
    have : p₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₀
    have : p₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁
    have : p₂ ^ 2  ≥ 0 := by
      exact sq_nonneg p₂
    have : p₃ ^ 2  ≥ 0 := by
      exact sq_nonneg p₃
    have : p₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₄
    have : p₅ ^ 2 ≥ 0 := by
      exact sq_nonneg p₅
    have : p₆ ^ 2 ≥ 0 := by
      exact sq_nonneg p₆
    have : p₇ ^ 2 ≥ 0 := by
      exact sq_nonneg p₇
    have : p₈ ^ 2 ≥ 0 := by
      exact sq_nonneg p₈
    have : p₉ ^ 2 ≥ 0 := by
      exact sq_nonneg p₉
    have : p₁₀ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₀
    have : p₁₁ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₁
    have : p₁₂ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₂
    have : p₁₃ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₃
    have : p₁₄ ^ 2 ≥ 0 := by
      exact sq_nonneg p₁₄
    linarith
  have l₁: 0 ≤ δ₂₁ := by
    rw [← h2]
    have : p₀' ^ 2 ≥ 0 := by
      exact sq_nonneg p₀'
    have : p₁' ^ 2 ≥ 0 := by
      exact sq_nonneg p₁'
    have : p₂' ^ 2 ≥ 0 := by
      exact sq_nonneg p₂'
    have : p₃' ^ 2 ≥ 0 := by
      exact sq_nonneg p₃'
    have : p₄' ^ 2 ≥ 0 := by
      exact sq_nonneg p₄'
    linarith
  have l₂: 0 ≤ δ₂₂ := by
    rw [← h3]
    have : p0 ^ 2 ≥ 0 := by
        exact sq_nonneg p0
    have : p1 ^ 2  ≥ 0 := by
        exact sq_nonneg p1
    have : p2 ^ 2  ≥ 0 := by
        exact sq_nonneg p2
    have : p3 ^ 2 ≥ 0 := by
        exact sq_nonneg p3
    have : p4 ^ 2 ≥ 0 := by
        exact sq_nonneg p4
    linarith
  rw [D₁]
  intro g
  have s₁ : 0 ≤ δ₂₁*g₃ := by
    exact Right.mul_nonneg l₁ g.left
  have s₂ : 0 ≤ δ₂₂*g₄  := by
    exact Right.mul_nonneg l₂ g.right
  linarith
